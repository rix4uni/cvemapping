# ğŸš¨ CVE-2026-21440 â€” Critical Security Vulnerability

<img width="1199" height="457" alt="G94XX20WIAAuE0T" src="https://github.com/user-attachments/assets/a24ff9c4-554c-4cf4-8c6b-baa5d6086192" />

### ğŸ§© Summary

**CVE-2026-21440** is a **critical path traversal vulnerability** affecting the **AdonisJS** framework, specifically its multipart file upload handling.

> âš ï¸ If exploited, attackers can write files **anywhere on the server**, potentially leading to **remote code execution (RCE)**.

---

## ğŸ·ï¸ Key Details

| Field                       | Value                   |
| --------------------------- | ----------------------- |
| **CVE ID**                  | CVE-2026-21440          |
| **Severity**                | ğŸ”´ **Critical**         |
| **CVSS v4.0**               | **9.2**                 |
| **CWE**                     | CWE-22 (Path Traversal) |
| **Attack Vector**           | Network                 |
| **Authentication Required** | âŒ No                    |

---

## ğŸ” Whatâ€™s the Issue?

AdonisJS improperly trusts **user-supplied filenames** during multipart file uploads.

When developers call:

```js
MultipartFile.move()
```

without strict sanitization, attackers can submit filenames like:

```
../../../../app/config/startup.js
```

This allows them to **escape the intended upload directory** and write files to arbitrary locations on the server.

---

## ğŸ’¥ Impact

An attacker can potentially:

* ğŸ“‚ **Write arbitrary files** anywhere the server process has permission
* ğŸ§¨ **Overwrite application files or configs**
* ğŸ–¥ï¸ Achieve **Remote Code Execution (RCE)**
* ğŸŒ Exploit the issue **remotely**, without authentication

This makes the vulnerability especially dangerous for **public file upload endpoints**.

---

## ğŸ“¦ Affected Versions

### âŒ Vulnerable

* `@adonisjs/bodyparser` **â‰¤ 10.1.1**
* `11.x` prereleases **before 11.0.0-next.6**

### âœ… Fixed

* **10.1.2**
* **11.0.0-next.6**

---

## ğŸ› ï¸ Remediation (Strongly Recommended)

### ğŸ” Immediate Fix

â¡ï¸ **Upgrade** to a patched version **as soon as possible**.

### ğŸ§¯ Temporary Mitigations

If upgrading isnâ€™t possible yet:

* ğŸ§¼ Sanitize filenames (reject `../`, absolute paths, null bytes)
* ğŸ§© Use safe options in `MultipartFile.move()`
* ğŸ”’ Require authentication for upload endpoints
* ğŸ“ Restrict filesystem write permissions
* ğŸ§± Use a WAF to detect path traversal attempts

---

## ğŸ•’ Disclosure Timeline

* ğŸ“… **January 2, 2026** â€” GitHub Security Advisory published
* ğŸ“… **January 2, 2026** â€” NVD entry released

---

## ğŸ“ Short Steps to Use the CVE-2026-21440 PoC Script

1. **Install dependency**  
   `pip install requests`

2. **Save script**  
   Copy the full Python code and save as `cve_2026_21440_poc.py`

3. **Find upload endpoint**  
   Identify the target's multipart file upload URL (e.g., `/upload`, `/api/files`). Test with browser or curl.

4. **Run safe test first**  
   `python3 cve_2026_21440_poc.py http://target:port/upload --safe --random`

5. **Check success**  
   - Terminal: Look for "SUCCESS: File likely written!" and suggested URL.  
   - Browser: Open the suggested URL â€“ if you see the PoC text, it's vulnerable.

6. **If vulnerable, try shell (optional)**  
   `python3 cve_2026_21440_poc.py http://target:port/upload --shell php --depth 5`

7. **Verify shell**  
   Access uploaded file (e.g., `http://target/shell.php?cmd=whoami`) for command output.

Use only on authorized targets! Start with `--safe`.

<img width="684" height="248" alt="cve-2026-21440" src="https://github.com/user-attachments/assets/fb3a553e-c63f-4e8f-b066-7b93d4a22fd1" />

---

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                       âš ï¸  DISCLAIMER  âš ï¸                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```
This CVE-2026-21440 Proof-of-Concept script is provided 
SOLELY for educational, research, and authorized security testing purposes.

âŒ You MAY use it on:
   â€¢ Systems you own
   â€¢ Systems you have explicit written permission to test

âŒ You MAY NOT use it for:
   â€¢ Unauthorized access to any system
   â€¢ Illegal activities of any kind
   â€¢ Malicious purposes

The author and distributor assume NO liability for:
   â€¢ Misuse of this tool
   â€¢ Damage caused to systems
   â€¢ Legal consequences from unauthorized use

Using this script against systems without permission 
violates laws in most countries (e.g., CFAA in the US, 
Computer Misuse Act in the UK).

By using this tool, you agree to:
   â€¢ Take full responsibility for your actions
   â€¢ Comply with all applicable laws

Stay ethical. Test responsibly. 
Report vulnerabilities to vendors.

âœ¦ Hack the planet â€” but legally âœ¦
