# CVE-2023-26469 漏洞利用工具

## 概述

这是一个针对 Jorani 1.0.0 版本的漏洞利用工具（PoC），该漏洞允许攻击者通过路径遍历和日志注入技术实现远程代码执行。

**⚠️ 警告：此工具仅用于安全研究和授权测试。未经授权使用此工具进行攻击是非法的。**

## 漏洞描述

CVE-2023-26469 是 Jorani 1.0.0 中的一个严重安全漏洞，结合了以下两个攻击向量：

1. **日志注入**：通过登录表单向应用程序日志文件注入恶意 PHP 代码
2. **路径遍历**：利用路径遍历漏洞访问并执行被注入的日志文件

攻击者可以利用这个漏洞在目标服务器上执行任意系统命令。

## 功能特性

- 自动获取 CSRF 令牌
- 向日志文件注入恶意 PHP 代码
- 通过路径遍历访问日志文件
- 提供交互式伪终端执行系统命令
- 支持 Windows 环境（使用 pyreadline3）
- 自动编码命令以绕过检测

## 环境要求

- Python 3.x
- 依赖库：
  - requests
  - pyreadline3（Windows 环境）

## 安装

```bash
pip install requests pyreadline3
```

## 使用方法

```bash
python poc.py <目标URL>
```

### 示例

```bash
python poc.py http://target-server.com
```

### 交互式命令执行

脚本成功执行后，会进入一个伪终端界面，你可以在其中执行系统命令：

```
user@jorani(PSEUDO-TERM)
$ whoami
$ ls -la
$ cat /etc/passwd
```

输入 `exit`、`quit` 或 `x` 退出程序。

## 工作原理

1. **初始化会话**：向目标服务器发送请求，获取会话 cookie 和 CSRF 令牌
2. **注入恶意代码**：通过登录表单的 `language` 参数进行路径遍历，向日志文件注入 PHP 代码
3. **触发执行**：访问日志文件页面，执行注入的 PHP 代码
4. **命令执行**：通过自定义 HTTP 头传递 Base64 编码的命令，获取执行结果

## 技术细节

- 使用随机生成的 HTTP 头字段名以绕过某些安全机制
- 命令通过 Base64 编码传输
- 利用 `X-REQUESTED-WITH` 头绕过重定向保护
- 自动根据当前日期生成目标日志文件名

## 免责声明

本工具仅供安全研究和教育目的使用。使用者必须：

- 仅在获得明确授权的系统上使用此工具
- 遵守所有适用的法律法规
- 对使用此工具造成的任何后果负全部责任

作者不对任何滥用或非法使用此工具的行为负责。


## 参考资料

- CVE-2023-26469
- Jorani 官方网站

## 许可证

本项目仅用于教育和安全研究目的。
