// 切换到目标数据库
db = db.getSiblingDB('ctf_challenge');

// 写入 Flag 到集合中
db.flags.insertMany([
    {
        "target": "secret_data",
        "flag": "flag{CVE_2025_14847_Mem_Leak_Success}",
        "note": "This data is sensitive and stays in memory buffer during active queries."
    },
    {
        "system_info": "admin_backup_key_0x12345",
        "hint": "Look deeper into the heap memory!"
    }
]);

// 模拟一些业务数据，增加内存中的干扰项，提高 CTF 难度
for (let i = 0; i < 50; i++) {
    db.fake_data.insertOne({
        "id": i,
        "timestamp": new Date(),
        "random_hex": Math.random().toString(16)
    });
}

print("CTF Database initialized and Flag inserted.");