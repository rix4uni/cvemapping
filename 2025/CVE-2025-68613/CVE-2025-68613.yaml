id: CVE-2025-68613

info:
  name: CVE-2025-68613 - n8n Workflow Automation Vulnerability
  author: rxerium
  severity: critical
  description: |
    n8n is a fair-code licensed workflow automation tool. This CVE represents a vulnerability in n8n workflow automation platform that could allow attackers to exploit the application. The vulnerability affects various versions of n8n and can be detected through the n8n signin page.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-68613
  metadata:
    vendor: n8n
    product: n8n Workflow Automation
    verified: true
    shodan-query: http.favicon.hash:-831756631
  tags: cve,cve2025,n8n

http:
  - method: GET
    path:
      - "{{BaseURL}}/signin"

    extractors:
      - type: regex
        name: base64_content
        group: 1
        regex:
          - '<meta name="n8n:config:sentry" content="([A-Za-z0-9+/=]+)"'
        internal: true

      - type: dsl
        name: decoded
        dsl:
          - 'base64_decode(base64_content)'
        internal: true

      - type: dsl
        name: version
        dsl:
          - 'replace_regex(decoded, ".*n8n@([0-9]+\\.[0-9]+\\.[0-9]+).*", "$1")'
        internal: true

      - type: dsl
        dsl:
          - '"n8n Version: " + version'

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "<title>n8n.io"
        case-insensitive: true

      - type: status
        status:
          - 200

      - type: dsl
        name: vulnerable
        dsl:
          - '(compare_versions(version, ">= 0.211.0") && compare_versions(version, "< 1.120.4")) || (compare_versions(version, ">= 1.121.0") && compare_versions(version, "< 1.121.1"))'
