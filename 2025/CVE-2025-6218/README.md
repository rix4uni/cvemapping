# ğŸ§ª CVE-2025-6218: Path Traversal en WinRAR

## ğŸ“Œ DescripciÃ³n

Este laboratorio demuestra cÃ³mo explotar la vulnerabilidad **CVE-2025-6218** en versiones vulnerables de **WinRAR** para Windows. Esta vulnerabilidad permite que un archivo `.rar` malicioso sobrescriba archivos fuera del directorio de extracciÃ³n usando rutas relativas (`..\..\`), lo que puede llevar a la ejecuciÃ³n de cÃ³digo o la manipulaciÃ³n de archivos sensibles.

> âš ï¸ **Este laboratorio es solo con fines educativos.** Debe ejecutarse en una **mÃ¡quina virtual aislada**, sin conexiÃ³n a redes productivas.

---

## ğŸ›¡ï¸ Versiones Vulnerables

La vulnerabilidad afecta a:

- **WinRAR 7.11 y anteriores** (incluyendo versiones 6.x y algunas 5.x).
- Las versiones vulnerables no filtran correctamente las rutas relativas (`..\..\`) durante la extracciÃ³n.
- **No afecta** a WinRAR 7.12 y posteriores.

Se recomienda encarecidamente actualizar a [WinRAR 7.12](https://www.win-rar.com/download.html) o superior.

---

## ğŸ¯ Objetivo del Laboratorio

- Entender el concepto de Path Traversal en archivos comprimidos.
- Observar cÃ³mo un archivo `.rar` manipulado puede sobrescribir archivos fuera del destino.
- Destacar la importancia de mantener el software actualizado.

---

## ğŸ§° Requisitos

- MÃ¡quina virtual con Windows 10 u 11.
- WinRAR 7.11 o anterior.
- Archivo de prueba: `C:\Users\victima\Desktop\importante.txt`
- WinRAR instalado o ejecutable (`winrar.exe`).
- Archivo malicioso `archivo_exploit.rar` (incluido en este ZIP).

---

## ğŸ› ï¸ PreparaciÃ³n del Entorno

1. **Instalar WinRAR vulnerable** (por ejemplo 7.11).
2. **Crear archivo legÃ­timo a sobrescribir**:
    ```powershell
    echo Archivo legÃ­timo > "C:\Users\victima\Desktop\importante.txt"
    ```

3. **Extraer `archivo_exploit.rar`** desde este laboratorio en cualquier carpeta (por ejemplo, `C:\temp`).

4. **Abrir el `.rar` con WinRAR** y extraerlo a un directorio cualquiera. El archivo serÃ¡ extraÃ­do con una ruta como:

    ```
    ..\..\Users\victima\Desktop\importante.txt
    ```

    Lo que resultarÃ¡ en que el archivo original serÃ¡ sobrescrito.

---

## ğŸ” QuÃ© se debe observar?

- Antes de la extracciÃ³n: `importante.txt` dice â€œArchivo legÃ­timoâ€.
- DespuÃ©s de extraer el `.rar` malicioso: dice â€œMALWARE INYECTADOâ€.
- La extracciÃ³n no ocurriÃ³ en el escritorio, pero el archivo fue sobrescrito debido a la ruta relativa.

---

## âœ… SoluciÃ³n

Actualizar WinRAR a la versiÃ³n **7.12 o superior**.

---

## ğŸ§ª Contenido del Repositorio

| Archivo                     | DescripciÃ³n                                               |
|----------------------------|-----------------------------------------------------------|
| `archivo_exploit.rar`      | Archivo comprimido con ruta de escape (`..\..\`)        |
| `importante.txt`           | Archivo legÃ­timo antes del ataque                         |
| `crear_rar_malicioso.bat`  | Script demostrativo para generar el `.rar` (si se desea)  |
| `README.md`                | Esta guÃ­a paso a paso                                     |

---

## ğŸ§‘â€ğŸ« Autor

ExplicaciÃ³n elaborada por [Sebastian Peinador](https://www.linkedin.com/in/sebastian-j-peinador/) para propÃ³sitos didÃ¡cticos y de investigaciÃ³n en ciberseguridad ofensiva.

---

## ğŸ“„ Licencia

Este material se distribuye bajo la licencia [MIT](LICENSE).

---

> Si te resulta Ãºtil, Â¡no olvides darle â­ al repo o compartirlo!
