FROM httpd:2.4.65

RUN sed -i 's/#LoadModule cgid_module/LoadModule cgid_module/' conf/httpd.conf && \
    sed -i 's/#LoadModule include_module/LoadModule include_module/' conf/httpd.conf

RUN echo "ServerName localhost" >> conf/httpd.conf && \
    echo "ScriptSock cgisock" >> conf/httpd.conf && \
    echo '<Directory "/usr/local/apache2/htdocs/lab">' >> conf/httpd.conf && \
    echo '    Options +Includes +ExecCGI' >> conf/httpd.conf && \
    echo '    AddType text/html .shtml' >> conf/httpd.conf && \
    echo '    AddOutputFilter INCLUDES .shtml' >> conf/httpd.conf && \
    echo '</Directory>' >> conf/httpd.conf

RUN mkdir -p /usr/local/apache2/htdocs/lab

COPY index.shtml /usr/local/apache2/htdocs/lab/index.shtml

EXPOSE 80
