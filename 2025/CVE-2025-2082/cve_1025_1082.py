import time

def wait_for_enter():
    input("\n>> ...")

def ask_choice(prompt, options):
    print(prompt)
    for key, text in options.items():
        print(f" {key}) {text}")
    choice = ""
    while choice not in options:
        choice = input("SeÃ§imin: ").strip()
    return choice

def stage_1():
    print("27 Mart 2024, Sabah")
    print("GÃ¶zlerini aÃ§Ä±yorsun. Telefon ekranÄ±nda kÄ±rmÄ±zÄ± simgeli bir mail bildirimi parlÄ±yor.")
    print(" GÃ¶nderen: Bilinmiyor")
    print(" Konu: 'Bir Tesla seni bekliyor...'")
    print('''â€œElimizde Tesla Model 3â€™e ait canlÄ± bir konum var. 
AracÄ± inceler sahibine â€˜ufakâ€™ bir ders verirsen, 
karÅŸÄ±lÄ±ÄŸÄ±nda cok fazla dolar alÄ±rsÄ±n. Kabul ediyor musun?â€''')
    choice = ask_choice("Karar ver:", {
        "1": "âœ… Kabul ediyorum",
        "2": "âŒ HayÄ±r, yasa dÄ±ÅŸÄ± olduÄŸunu dÃ¼ÅŸÃ¼nÃ¼yorum"
    })
    if choice == "2":
        print("Yasa dÄ±ÅŸÄ± olduÄŸunu dÃ¼ÅŸÃ¼ndÃ¼ÄŸÃ¼n iÃ§in vazgeÃ§iyorsun. Hikaye burada biter.")
        exit()
    print("GÃ¶revi kabul ettin. HazÄ±rlÄ±klara baÅŸlÄ±yorsun.")
    wait_for_enter()

def stage_2():
    print("27 Mart 2024, GÃ¼n Boyu")
    print("Ä°ÅŸ yerinden izin alÄ±yorsun. TÃ¼m gÃ¼nÃ¼nÃ¼ araÅŸtÄ±rmaya ayÄ±rÄ±yorsun...")
    print("\nÄ°ncelediklerin:")
    wait_for_enter()
    print("- Tesla Model 3'Ã¼n elektronik mimarisi: AraÃ§taki sistemler birbirine nasÄ±l baÄŸlÄ±?")
    print("- VCSEC modÃ¼lÃ¼: AracÄ±n gÃ¼venliÄŸini saÄŸlayan yazÄ±lÄ±m-donanÄ±m bileÅŸeni.")
    print("- TPMS (Lastik BasÄ±nÃ§ Ä°zleme Sistemi) protokolÃ¼: Lastik sensÃ¶rleri aracÄ±n kontrol Ã¼nitesine veri gÃ¶nderiyor.")
    wait_for_enter()
    print("- TPMS cihazlarÄ±ndan gelen veriler doÄŸrulanmÄ±yor, yani gÃ¼venlik kontrolÃ¼ yok.")
    print("- Bu sayede, sahte veriler ile sisteme saldÄ±rÄ± yapÄ±labilirisin.")
    print("- Ã–zellikle, 'integer overflow' aÃ§Ä±ÄŸÄ± sayesinde bellekte beklenmedik etkiler yaratÄ±labilirsin.")
    wait_for_enter()
    print("- VCSEC modÃ¼lÃ¼, aracÄ±n CAN bus aÄŸÄ±na doÄŸrudan baÄŸlÄ±dÄ±r.")
    print("- CAN bus; motor, kapÄ±lar, Ä±ÅŸÄ±klar gibi tÃ¼m araÃ§ bileÅŸenlerinin iletiÅŸim aÄŸÄ±dÄ±r.")
    print("- EÄŸer VCSEC ele geÃ§irilirse, araÃ§ Ã¼zerindeki kontrol tamamen ele geÃ§irilebilir.")
    print("\nKÄ±saca, TPMS protokolÃ¼ndeki bu zafiyet seni aracÄ±n kritik sistemlerine eriÅŸtiriyor!")
    wait_for_enter()

def stage_3():
    print("27 Mart 2024, Gece")
    print("Plan hazÄ±r.")
    wait_for_enter()

def stage_4():
    print("28 Mart 2024, Saat 05:42")
    print("SoÄŸuk bir sabah. Hedef Tesla Model 3 park hÃ¢linde. Araca yaklaÅŸÄ±yorsun.")
    time.sleep(5)
    print("YanÄ±nda Fake TPMS Transmitter devre kartÄ±.")
    print("AracÄ±n TPMS sensÃ¶rleri Bluetooth Ã¼zerinden iletiÅŸim kuruyor.")
    print("Bluetooth taramasÄ± baÅŸlatÄ±lÄ±yor...")
    time.sleep(5)
    print("Tesla TPMS sinyalleri tespit edildi. Sahte paket hazÄ±rlanÄ±yor:")
    time.sleep(5)
    print('''\n// Overflow'u tetikleyecek sahte veri
uint8_t malicious_payload[256] = {
   0xFF, /* count */
   // shellcode payload
   ...
};''')
    print(" Paket gÃ¶nderiliyor...")
    time.sleep(3)
    print(" Paket baÅŸarÄ±yla gÃ¶nderildi.")
    print(" VCSEC modÃ¼lÃ¼ne eriÅŸim saÄŸlandÄ±. ")
    wait_for_enter()

def stage_5():
    print("Integer overflow tetiklendi. Shellcode Ã§alÄ±ÅŸtÄ±rÄ±lÄ±yor.")
    print("CAN bus kontrolÃ¼ senin ellerinde!")
    print("Ne yapmak istersin?")
    while True:
        choice = ask_choice("Komut gÃ¶nder:", {
            "1": "KapÄ±larÄ± AÃ§ (UNLOCK_DOORS)",
            "2": "Motoru Kapat (DISABLE_ENGINE)",
            "3": "FarlarÄ± Yak-SÃ¶ndÃ¼r (FLASH_LIGHTS)",
            "4": "KaÃ§ (Ã‡Ä±kÄ±ÅŸ)"
        })
        if choice == "1":
            print("â¡ï¸ KapÄ±lar kilidini aÃ§tÄ±.")
        elif choice == "2":
            print("â›” Motor kendini kapattÄ±.")
        elif choice == "3":
            print("ğŸ’¡ Farlar yanÄ±p sÃ¶nÃ¼yor.")
        elif choice == "4":
            print(" BilgisayarÄ±nÄ± kapatÄ±p uzaklaÅŸÄ±yorsun...")
            break
        time.sleep(1)

def stage_6():
    print("\n GÃ¶rev tamamlandÄ±.")
    print("Kod satÄ±rlarÄ±yla bir arabayÄ± kontrol ettin.")
    time.sleep(3)
    print("Bu bir korsanlÄ±k deÄŸil â€“ bu, siber-fiziksel bir gÃ¼Ã§ gÃ¶sterisi.")
    time.sleep(3)
    print("- Zafiyet, sÃ¼rÃ¼cÃ¼ farkÄ±na bile varmadan sÃ¶mÃ¼rÃ¼lebilir.")
    time.sleep(3)
    print("- Synacktiv ÅŸiketi bunu yaptÄ±. Tesla yamayÄ± yayÄ±nladÄ±.")
    time.sleep(3)

def main():
    print("ğŸš¨ CVE-2025-2082 Senaryosu BaÅŸlÄ±yor...")
    print("ğŸš¨ Bu Senaryo da Hicbir Veriye Zarar VerilmemiÅŸtir.")
    wait_for_enter()
    stage_1()
    stage_2()
    stage_3()
    stage_4()
    stage_5()
    stage_6()
    print("ğŸš¨ Senaryo TamamlandÄ±. TeÅŸekkÃ¼rler!")
    print("ğŸš¨ Bu bir eÄŸitim senaryosudur. GerÃ§ek hayatta bu tÃ¼r eylemler yasadÄ±ÅŸÄ±dÄ±r.")
    
if __name__ == "__main__":
    main()
