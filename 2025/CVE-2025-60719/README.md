# CVE-2025-60719-AFD.SYS
> Akamai researchers have created a new AI capability for instant root-cause analysis. The tool is a supervised multi-agent system, dubbed Patchdiff-AI. In this article we are using it for deep analysis of CVE-2025-60719, that affects all Windows versions. 

> [!NOTE]
> ### The tool and the research will be presented at [Black Hat Europe Arsenal](https://blackhat.com/eu-25/arsenal/schedule/index.html#patch-wednesday---multi-agent-system-for-patch-diffing-48243) on Wednesday, December 10, at ExCeL London.

> * The Vulnerability: A Use-After-Free (UAF) vulnerability in the Windows Ancillary Function Driver for WinSock (afd.sys) caused by a race condition.
> * The Impact: Local Elevation of Privilege (EoP). An attacker with low privileges can manipulate the kernel memory and gain SYSTEM privileges.
> * Root Cause: The driver failed to prevent a socket endpoint from being unbound (freed) while other operations (like Transfer, GetInformation, or Connect) were actively dereferencing its associated objects.
> * The Fix: Microsoft added a synchronization barrier mechanism (AfdPreventUnbind / AfdReallowUnbind) to explicitly lock the endpoint state during critical operations.

### Keep reading the [full article](https://www.akamai.com/blog/security-research/cve-2025-60719-analysis)

![fig_6_video](https://github.com/user-attachments/assets/63000cef-1a37-48af-8356-ac26d75d9333)
---
## License

Copyright 2025 Akamai Technologies Inc.

Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at

>http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.
