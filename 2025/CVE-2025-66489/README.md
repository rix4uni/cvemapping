# üö® CVE-2025-66489 : Critical Authentication Bypass in Cal.com

![G7tMizJacAAtZgh](https://github.com/user-attachments/assets/f2a26b48-4e0d-4886-a6a1-373880d0876b)

---

## üß≠ At a Glance

| üîé Item                 | üìå Details                                   |
| ----------------------- | -------------------------------------------- |
| **CVE ID**              | **CVE-2025-66489**                           |
| **Product**             | Cal.com (Open-source scheduling platform)    |
| **Severity**            | üî¥ **CRITICAL**                              |
| **CVSS v4.0**           | **9.9 / 10**                                 |
| **CWE**                 | CWE-303 ‚Äî Incorrect Authentication Algorithm |
| **Attack Vector**       | üåê Remote (Network)                          |
| **Privileges Required** | ‚ùå None                                       |
| **User Interaction**    | ‚ùå None                                       |

---

## üß® What Went Wrong

Cal.com‚Äôs authentication logic contains a **fatal conditional flaw**:

> When a **TOTP (2FA) code** is supplied, the system **fails to validate the password**.

This allows attackers to **bypass primary authentication entirely**.

---

## üîì Why This Is Dangerous

* üîë **Password verification is skipped**
* üë§ **Unauthorized logins possible**
* üóìÔ∏è **Full account takeover**
* üîê **2FA security model is broken**
* ‚ö° **Easy to exploit remotely**

Even users with **multi-factor authentication enabled** are vulnerable.

---

## üéØ Attack Scenario (Simplified)

1. Attacker knows a user‚Äôs **email**
2. Supplies a crafted or intercepted **TOTP**
3. ‚ùå Password check is skipped
4. ‚úÖ Attacker gains access

---

## üõ†Ô∏è Affected Versions

‚ùå **All versions ‚â§ 5.9.7**
‚úÖ **Patched in version 5.9.8**

---

## ‚úÖ Remediation (Do This Now)

### üîÑ Immediate Fix

* **Upgrade to Cal.com v5.9.8 or later**

### üßØ Temporary Mitigations (if patching is delayed)

* Restrict access to authentication endpoints
* Monitor login anomalies (TOTP-only attempts)
* Enforce network-level access controls

---

## üß† Risk Summary

> **CVE-2025-66489 enables full account compromise with no credentials and no interaction.**

This is a **patch-now, ask-questions-later** vulnerability.

---

### Prerequisites
- A vulnerable Cal.com instance (self-hosted or demo).
- Python 3.x with `requests` library (`pip install requests`).
- Obtain the CSRF token manually from the login page (inspect the form via browser dev tools).

---

### How to Run
1. Save the script as `CVE-2025-66489.py`.
2. Get the CSRF token:
   - Visit the login page (e.g., `http://localhost:3000/auth/login`).
   - Inspect the form and copy the value of the `csrfToken` input field.
3. Execute:

---

   ```
   sudo python3 CVE-2025-66489.py --url http://localhost:3000 --email free@example.com --password wrongpass --totp 123456 --csrf YOUR_CSRF_TOKEN_HERE
   ```
   
   - Replace values as needed.

### Expected Output (Success)

```
[+] Bypass successful! Logged in without correct password.
[+] Session cookies: {'next-auth.session-token': '...'}
[+] Access to dashboard confirmed.
```

### Explanation
- The script sends a POST to `/api/auth/callback/credentials` with the email, wrong password, and a fake TOTP code.
- Due to the bug, providing `totpCode` skips the password verification.
- If successful, it establishes a session and can access protected areas like `/dashboard`.

### Important Notes
- **Test Ethically**: Only run this on your own instances or with explicit permission. Unauthorized use is illegal.
- **Mitigation**: Upgrade to Cal.com >= 5.9.8 immediately.
- **No Exploits in Wild**: As of December 21, 2025, no widespread exploitation reported.
- Inspired by public reproductions (e.g., from security researchers on GitHub and X).

---

If you run the **CVE-2025-66489.py** PoC script successfully on a **vulnerable Cal.com instance** (version ‚â§ 5.9.7), here's exactly what you'll see in the terminal output:

### Successful Exploitation Output

```
[+] Bypass successful! Logged in without correct password.
[+] Session cookies: {'next-auth.session-token': 'some-long-session-token-value-here'}
[+] Access to dashboard confirmed.
```

- This means the authentication bypass worked: You logged in using a **wrong password** but a dummy/fake TOTP code (like "123456").
- The script now has a valid session cookie, allowing access to protected pages (e.g., the user's dashboard at `/dashboard`).

### What Happens Next / What You'll See in the Browser
1. Take the `next-auth.session-token` value from the output.
2. Open your browser and go to the Cal.com instance (e.g., `http://localhost:3000` or your target URL).
3. Use dev tools (F12) ‚Üí Application tab ‚Üí Cookies ‚Üí Add or edit the cookie named `next-auth.session-token` with that value.
4. Refresh the page ‚Äî you'll be **logged in as the target user** without ever entering the correct password.
5. You'll see the full dashboard: scheduling links, bookings, settings, etc., just like a legitimate login.

### If It Fails (e.g., on a Patched Instance ‚â• 5.9.8)

[-] Bypass failed. Response: {"error":"Invalid credentials"}  (or similar authentication error message)

- No session cookie is set.
- You won't get access to the dashboard.

### Quick Test Tips
- Use a **dummy TOTP** like `123456` or any 6-digit number ‚Äî the bug accepts **any non-empty TOTP** as "valid" and skips password check.
- Make sure the CSRF token is fresh (grab it from the login page source).
- This is a **real critical vulnerability** (CVSS ~9.9) published early December 2025, fixed in 5.9.8.

Again: **Only test on systems you own or have explicit permission for**. Unauthorized use is illegal.

---

### **Short Disclaimer**

This information and PoC are for **educational and authorized testing purposes only**.  
Do **not** use them on any system without explicit permission.  
Unauthorized exploitation is illegal and may result in severe consequences.  
Upgrade vulnerable Cal.com instances immediately.  

Use responsibly. üõ°Ô∏è
