id: http-node-custommcp-detect
info:
  name: Detect presence of /api/v1/node-load-method/customMCP (benign)
  author: zimshk
  severity: info
  description: Sends a harmless POST to detect the presence of the endpoint; does not execute code.
requests:
  - method: POST
    path:
      - "{{BaseURL}}/api/v1/node-load-method/customMCP"
    headers:
      Content-Type: application/json
      Authorization: "Bearer {{authorization}}"
    body: |
      {
        "loadMethod": "listActions",
        "inputs": {
          "mcpServerConfig": "{}"
        }
      }
    matchers:
      - type: status
        status: [200, 201, 400, 422]
      - type: word
        words:
          - "listActions"
          - "inputs"
        condition: or
