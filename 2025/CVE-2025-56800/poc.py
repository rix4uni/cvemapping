import re
from pathlib import Path

target_path = Path.home() / (
    "AppData/Local/Programs/Reolink/resources/app/"
    "~node_modules_sharp_vendor_Sync_recursive_versions_json_~private_main_index_ts.js"
)

with open(target_path, "r", encoding="utf-8") as f:
    content = f.read()

pattern = re.compile(
    r'(this\.registerCommonCmd\(\s*"get_settings_lock_screen_password".+?return\s+\[2,\s*a\.settingsManager\.lockScreenPassword\s*\];)',
    re.DOTALL
)

replacement = r'return [2, ""];'

def patch_handler(match):
    return match.group(0).replace(
        'return [2, a.settingsManager.lockScreenPassword];', replacement
    )

patched, count = pattern.subn(patch_handler, content)

if count > 0:
    with open(target_path, "w", encoding="utf-8") as f:
        f.write(patched)
    print(f"[+] Successfully patched lock screen handler.")
else:
    print("[!] Failed to locate or patch handler. Please ensure the file has not already been patched or altered.")