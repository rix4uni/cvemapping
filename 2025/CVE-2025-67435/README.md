# CVE-2025-67435
## Researcher : Chowdhury Faizal Ahammed
## PluckCMS Zip Slip Remote Code Execution Vulnerability Report

## Executive Summary

This report documents a critical security vulnerability discovered in PluckCMS that allows authenticated attackers to achieve remote code execution through a Zip Slip attack vector. The vulnerability exists in the module upload functionality and can be exploited by uploading a specially crafted ZIP archive containing malicious PHP code.

## Vulnerability Details

**Vulnerability Type:** Zip Slip leading to Remote Code Execution (RCE)

**Affected Component:** Module Management System (Options → Manage Modules)

**Attack Vector:** Malicious ZIP file upload

**Authentication Required:** Yes (Admin panel access)

**Severity:** Critical

## Technical Description

The vulnerability stems from inadequate validation and sanitization of ZIP archive contents during the module upload process. PluckCMS allows administrators to upload modules in ZIP format without properly validating the file paths contained within the archive. This enables an attacker to craft a malicious ZIP file that exploits path traversal vulnerabilities, allowing arbitrary file placement on the server filesystem.

When a ZIP archive is extracted, the application fails to verify that extracted files remain within the intended directory structure. An attacker can leverage this weakness to write malicious PHP files to web-accessible locations, subsequently executing arbitrary code on the server.

## Proof of Concept

### Environment Setup

The vulnerability can be reproduced using the following environment:

```bash
git clone https://github.com/pluck-cms/pluck.git
cd pluck
ddev config --project-type=php --docroot=.
ddev start
```
<img width="2048" height="1307" alt="image" src="https://github.com/user-attachments/assets/9ab92776-e662-430b-96e5-8807e27e7dc5" />

<img width="2012" height="838" alt="image" src="https://github.com/user-attachments/assets/106fc952-25cd-4c51-9e00-0706ddf7ecaf" />

**Hosted URL** : [http://pluck.ddev.site](http://pluck.ddev.site/) 

### Exploitation Steps

1. **Access the Admin Panel**: Navigate to the PluckCMS installation and authenticate with administrative credentials
2. **Navigate to Module Management**: Go to Options → Manage Modules
3. **Prepare Malicious Payload**: Create a PHP file with malicious code and package it in a ZIP archive with crafted file paths
4. **Upload the Archive**: Use the module upload functionality to submit the malicious ZIP file
5. **Trigger Execution**: Access the uploaded PHP file through the web server to execute arbitrary commands

<img width="2048" height="1358" alt="image" src="https://github.com/user-attachments/assets/97463b10-6212-4e7f-8a23-71c9507cf421" />

<img width="2048" height="1358" alt="image" src="https://github.com/user-attachments/assets/0058bf78-e724-47d5-95b2-5a6a1903a1e0" />

<img width="2048" height="1358" alt="image" src="https://github.com/user-attachments/assets/89ca05f5-9d64-4417-889d-56da5140b9fc" />

<img width="2048" height="1358" alt="image" src="https://github.com/user-attachments/assets/729fe52a-d4f7-4631-9108-5b8db0881803" />

<img width="2048" height="1307" alt="image" src="https://github.com/user-attachments/assets/15dfbdb6-5afa-4262-a121-2a3f629a0612" />

<img width="2048" height="1358" alt="image" src="https://github.com/user-attachments/assets/9f510846-11a1-483a-bb50-7fd6af14b1ee" />

<img width="2048" height="1358" alt="image" src="https://github.com/user-attachments/assets/98e1b791-8af4-4ae9-8567-664a6a739410" />


### Example Payload

A proof-of-concept payload demonstrating command execution capability was used during testing. The payload leverages PHP's system execution functions to run operating system commands.

```php
<?php
$fn = "sys" . "tem";
(string) $fn("id");
?>
```

## Impact Assessment

Successful exploitation of this vulnerability allows an authenticated attacker with administrative access to:

- Execute arbitrary system commands on the host server
- Read, modify, or delete sensitive files and databases
- Compromise the confidentiality, integrity, and availability of the system
- Pivot to other systems on the network
- Establish persistent backdoors for continued access

While the vulnerability requires administrative authentication, it represents a critical security risk as it provides a direct path to full system compromise.

## Affected Versions
`4.7.20`

## Recommendations

### Immediate Actions

1. **Restrict Module Upload Access**: Limit module upload functionality to trusted administrators only
2. **Monitor Upload Activity**: Review logs for suspicious ZIP file uploads
3. **File Integrity Checks**: Verify that no malicious files have been uploaded to the system

## References

- GitHub Repository: https://github.com/pluck-cms/pluck.git
- OWASP Zip Slip Vulnerability: https://owasp.org/www-community/vulnerabilities/Zip_Slip
