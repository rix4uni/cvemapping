# PostGallery-CVE-Report
Disclosure for CVE-2025-13543


# CVE-2025-13543 - Vulnerability in PostGallery

This repository discloses a vulnerability discovered in [PostGallery <= 1.12.5](https://wordpress.org/plugins/postgallery/),WordPress plugin developed by rtowebsites.

## ğŸ›  Affected Version

- **Product**: PostGallery
- **Version**: <= 1.12.5
- **URL**: https://wordpress.org/plugins/postgallery/

---

## ğŸ”’ Assigned CVE
| CVE ID            | Type                      | Component                | Impact                    |
|-------------------|---------------------------|--------------------------|---------------------------|
| CVE-2025-13543    |  Authenticated (Subscriber+) Arbitrary File Upload                |  lib/ajax-actions/imageUpload.phpã€€  admin/PostGalleryUploader.php          | Unauthenticated attacker can upload arbitrary file     |  

---

## ğŸ§¾ Detailed a Description

### CVE-2025-13543 â€” Authenticated (Subscriber+) Arbitrary File Upload

 - **Affected Component**: PostGallery AJAX upload handler (`postgalleryAjaxUpload`) and `PostGalleryUploader` backend
 - **Attack Vector**: Authenticated (Subscriber+) Arbitrary File Upload via directory traversal.
 - **Trigger**: Any authenticated low-privileged user (such as a Subscriber) can upload arbitrary PHP files to attacker-controlled paths via directory traversal.

```
curl -k -X POST "http://localhost:8080/wp-admin/admin-ajax.php" \
  -H "Cookie: wordpress_logged_in_<hash>=<your_cookie>" \
  -F "action=postgalleryAjaxUpload" \
  -F "postid=1" \
  -F "uploadFolder=../../../" \
  -F "name=shell.php" \
  -F "file=@shell.php;type=application/x-php"
```

 - **Impact**: Any authenticated low-privileged user (such as a Subscriber) can upload arbitrary PHP files to attacker-controlled paths via directory traversal. This allows remote code execution in the context of the web server, leading to full site compromise, including modification of site content, exfiltration of `wp-config.php` and database credentials, deployment of persistent backdoors, and creation of rogue administrator accounts.

## â“Reason for the vulnerability
- In `lib/ajax-actions/imageUpload.php`, enforce proper authorization (for example, require `current_user_can('upload_files')`) and validate a cryptographic nonce before processing uploads.
- In `admin/PostGalleryUploader.php`, strictly constrain `uploadFolder` to a known subdirectory of `wp-content/uploads/gallery`, reject any value containing `../` or absolute paths, and normalize paths before use.
- Use WordPressâ€™ standard upload APIs such as `wp_handle_upload()` / `wp_check_filetype_and_ext()` and restrict uploads to a whitelist of non-executable media types, explicitly blocking `.php` and other executable extensions in web-accessible directories.

## ã²ã¨ã“ã¨
ã“ã‚“ãªCTFã¿ãŸã„ãªè„†å¼±æ€§ãŒå­˜åœ¨ã™ã‚‹ãªã‚“ã¦...ã¨æ€ã£ãŸã€‚
ä»»æ„ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã ã‘ã§ã‚‚ã‚„ã°ã„ã®ã«ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«ãŒã‚ã‚‹ã¨ã„ã†çµ¶æœ›
è„†å¼±æ€§ã®å†ç¾ãŒã¨ã¦ã‚‚æ¥½ã—ã‹ã£ãŸã€‚

## ğŸ” Discoverer

**Name**: MooseLove  
**Role**: Independent security researcher / bug hunter  
**Contact**: Available upon request  

---

## ğŸ“š References

- Product: https://wordpress.org/plugins/postgallery/

---

## âš ï¸ License

This advisory is provided for public security awareness. Free to share with attribution.
