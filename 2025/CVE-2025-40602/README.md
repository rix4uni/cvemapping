# <img src="https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Locked.png" alt="Locked" width="25" height="25" /> CVE-2025-40602

CVE-2025-40602 is a local privilege escalation vulnerability in the appliance management console (AMC) of SonicWall Secure Mobile Access (SMA) 1000 series appliances. The vulnerability stems from insufficient authorization in the AMC, allowing authenticated remote attackers to escalate privileges on affected devices. When chained with CVE-2025-23006, attackers can achieve unauthenticated remote code execution with root privileges. This zero-day vulnerability has been actively exploited in the wild and was added to CISA's Known Exploited Vulnerabilities catalog on December 17, 2025.

## <img src="https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Magnifying%20Glass%20Tilted%20Left.png" alt="Search" width="25" height="25" /> How does this detection method work?
This Nuclei template uses a strictly conservative detection approach that only flags explicitly verified vulnerable versions with complete build numbers. The template employs two active DSL matchers: `contains(version, "12.4.3-") && compare_versions(version, "<= 12.4.3-03093")` identifies SMA appliances running 12.4.3 platform-hotfix builds numbered 03093 or lower, while `contains(version, "12.5.0-") && compare_versions(version, "<= 12.5.0-02002")` targets 12.5.0 builds numbered 02002 or lower. Version information is extracted from the HTTP Server header (e.g., `Server: SMA/12.4.3-03093`), and detection requires both successful version matching AND body content verification confirming "Appliance Management Console" or "SonicWall" presence. 

Notably, the template includes commented-out matchers for ambiguous versions (`version == "12.4.3"` and `version == "12.5" || version == "12.5.0"`) that lack build numbersâ€”these are intentionally disabled to prevent false positives, as versions
without build numbers cannot definitively determine vulnerability status (e.g., `SMA/12.5.0` could be either vulnerable build 02002 or patched build 02283). This design ensures zero false positives by only flagging systems where the complete version string (including build number) can be verified against the official advisory's vulnerable ranges, making the template suitable for high-confidence vulnerability scanning where accuracy is prioritized over broad coverage.

## <img src="https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Travel%20and%20places/Rocket.png" alt="Rocket" width="25" height="25" /> How do I run this script?

1. Download and install [Nuclei](https://github.com/projectdiscovery/nuclei).
2. Clone this repostory to your local system.
3. Run the following command: 
```sh
nuclei -u <ip|fqdn> -t template.yaml
```

Or if you would like to scan a list of hosts, execute:
```sh
nuclei -l <list.txt> -t template.yaml
```


## <img src="https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Books.png" alt="Books" width="25" height="25" /> References

  - https://nvd.nist.gov/vuln/detail/CVE-2025-40602
  - https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2025-0019
  - https://www.cisa.gov/known-exploited-vulnerabilities-catalog
  - https://thehackernews.com/2025/12/sonicwall-fixes-actively-exploited-cve.html
  - https://www.tenable.com/blog/cve-2025-40602-sonicwall-secure-mobile-access-sma-1000-zero-day-exploited
  - https://www.bleepingcomputer.com/news/security/sonicwall-warns-of-new-sma1000-zero-day-exploited-in-attacks/


## <img src="https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Symbols/Warning.png" alt="Warning" width="25" height="25" /> Disclaimer

Use at your own risk, I will not be responsible for illegal activities you conduct on infrastructure you do not own or have permission to scan.

---

## <img src="https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Page%20with%20Curl.png" alt="License" width="25" height="25" /> License

This project is licensed under the MIT License.

## <img src="https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Speech%20Balloon.png" alt="Contact" width="25" height="25" /> Contact

If you have any questions about this vulnerability detection script please reach out to me via [Signal](https://signal.me/#eu/0Qd68U1ivXNdWCF4hf70UYFo7tB0w-GQqFpYcyV6-yr4exn2SclB6bFeP7wTAxQw).

If you would like to connect, I am mostly active on [Twitter/X](https://x.com/rxerium) and [LinkedIn](https://www.linkedin.com/in/rxerium/).
