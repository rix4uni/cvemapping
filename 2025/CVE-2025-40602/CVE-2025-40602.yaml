id: CVE-2025-40602

info:
  name: CVE-2025-40602 - SonicWall SMA 1000 AMC Privilege Escalation
  author: rxerium
  severity: medium
  description: |
    CVE-2025-40602 is a local privilege escalation vulnerability in the appliance management console (AMC) of SonicWall Secure Mobile Access (SMA) 1000 series appliances. The vulnerability stems from insufficient authorization in the AMC, allowing authenticated remote attackers to escalate privileges on affected devices. When chained with CVE-2025-23006, attackers can achieve unauthenticated remote code execution with root privileges. This zero-day vulnerability has been actively exploited in the wild and was added to CISA's Known Exploited Vulnerabilities catalog on December 17, 2025.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-40602
    - https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2025-0019
    - https://www.cisa.gov/known-exploited-vulnerabilities-catalog
    - https://thehackernews.com/2025/12/sonicwall-fixes-actively-exploited-cve.html
    - https://www.tenable.com/blog/cve-2025-40602-sonicwall-secure-mobile-access-sma-1000-zero-day-exploited
    - https://www.bleepingcomputer.com/news/security/sonicwall-warns-of-new-sma1000-zero-day-exploited-in-attacks/
  metadata:
    max-request: 2
    vendor: sonicwall
    product: secure-mobile-access-sma-1000
    cvss-score: 6.6
    cwe-id: CWE-285
    cisa-kev: true
    verified: true
    shodan-query: title:"Appliance Management Console"
  tags: cve,cve2025,sonicwall,sma,privilege-escalation,kev,zero-day

http:
  - method: GET
    path:
      - "{{BaseURL}}/login.action"

    extractors:
      - type: kval
        name: server_header
        part: header
        kval:
          - Server
        internal: true

      - type: regex
        name: version
        part: header
        group: 1
        regex:
          - 'SMA/([0-9]+\.[0-9]+\.[0-9]+-[0-9]+)'
          - 'SMA/([0-9]+\.[0-9]+)'
        internal: false

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "<title>Appliance Management Console Login"
        part: body

      - type: status
        status:
          - 200

      - type: dsl
        dsl:
          # 12.4.3 without build number - ambiguous, flag for review (commented out)
          # - 'version == "12.4.3"'
          # 12.4.3 with specific vulnerable builds (up to 03093)
          - 'contains(version, "12.4.3-") && compare_versions(version, "<= 12.4.3-03093")'
          # 12.5.x branch: Generic 12.5 or 12.5.0 without build - ambiguous (commented out)
          # - 'version == "12.5" || version == "12.5.0"'
          # 12.5.0 with specific vulnerable builds (up to 02002)
          - 'contains(version, "12.5.0-") && compare_versions(version, "<= 12.5.0-02002")'
        condition: or
