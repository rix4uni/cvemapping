from scapy.all import * #pyright: ignore noqa

# Define Ethernet parameters
ether_src = "58:11:22:09:23:08"
ether_dst = "33:33:00:00:00:01" # Multicast address for all IPv6 nodes
ether_packet = Ether(src=ether_src, dst=ether_dst)

# Define IPv6 parameters
ipv6_src = "2600:1700:1960:584f:aee3:319e:eccc:d359"
#ipv6_dst = "fe80::a2:5d88:e3a3:1ff"
ipv6_dst = "ff02::1" # Multicast address for all IPv6 nodes
hop_limit = 255

# Define ICMPv6 Router Advertisement parameters
router_lifetime = 1800 # Router lifetime in seconds
reachable_time = 0
retrans_timer = 0
# Create the packets
ipv6_packet = IPv6(dst=ipv6_dst, hlim=hop_limit)
icmpv6_ra_packet = ICMPv6ND_RA(
    routerlifetime=router_lifetime,
    reachabletime=reachable_time,
    retranstimer=retrans_timer
)

icmpv6_lladdr = ICMPv6NDOptSrcLLAddr(
    lladdr=ether_src
)

icmpv6_mtu = ICMPv6NDOptMTU()

# Define Prefix Information Option (Option 24) parameters
prefix = "d00d::"
prefix_length = 64
valid_lifetime = 360
preferred_lifetime = 180

icmpv6_opt_prefix_info = ICMPv6NDOptPrefixInfo(
    prefix=prefix,
    prefixlen=prefix_length,
    validlifetime=valid_lifetime,
    preferredlifetime=preferred_lifetime
)

# Combine the packets
packet = ether_packet / ipv6_packet / icmpv6_ra_packet / icmpv6_lladdr / icmpv6_mtu / icmpv6_opt_prefix_info

# Send the packet
print("IPv6 Router Advertisement with Prefix Information Option sent.")
sendp(packet, iface="enp5s0", verbose=False)
