# ASUS Driver LPE PoC (Physical Memory Abuse)

![Platform](https://img.shields.io/badge/Platform-Windows%20x64-blue)
![Language](https://img.shields.io/badge/Language-C%2B%2B-orange)
![Type](https://img.shields.io/badge/Type-Local%20Privilege%20Escalation-red)

This is a PoC for **Local Privilege Escalation (LPE)** that exploits the `AsInsHelp64.sys` driver.
It abuses a legitimate, signed ASUS driver to map physical memory and overwrite kernel tokens, eventually gaining `NT AUTHORITY\SYSTEM` privileges.

## ðŸŽ¯ Vulnerability Info

* **Target**: `AsInsHelp64.sys` (Related to ASUS Fan Xpert < v.10013)
* **Technique**: Arbitrary Physical Memory Read/Write
* **Root Cause**:
    The driver exposes an IOCTL that lets any user map physical memory into their virtual address space. By exploiting this, we can modify critical kernel structures without any permission checks.
## ðŸ“‹ Supported Environment
* **OS**: Windows 10 (2004) ~ Windows 11 (23H2) x64
* **Driver**: `AsInsHelp64.sys` must be loaded.
* **Tools**: WinDbg (Required for stability).

## ðŸš€ Usage

1.  **Run the Exploit**
2.  **Get Info from WinDbg**:
    Instead of risking a crash by scanning memory, retrieve the exact addresses manually:
    * Get System EPROCESS & CR3: `!process 0 0 System`
    * Get System Token: `dq <System_EPROCESS>+4b8 L1`
3.  **Input & Pwn**: Enter the values into the tool. It will automatically find your process and swap the token.

## ðŸ“– Step-by-Step Walkthrough

### 1. Launch the Tool
Run the compiled. The program will ask for System information.
<img width="621" height="337" alt="image" src="https://github.com/user-attachments/assets/13bdc008-4576-4c13-bced-b3f35f6ce815" />

### 2. Retrieve System Info (WinDbg)
Open WinDbg and execute the following command to find the `System` process:
```
!process 0 0 System
```
Copy the address following PROCESS and the value of DirBase(CR3)
<img width="686" height="393" alt="image" src="https://github.com/user-attachments/assets/db5275c4-1702-4f7f-9cf6-e06e97705b5f" />
<img width="621" height="337" alt="image" src="https://github.com/user-attachments/assets/47420a55-b18b-46d2-8752-554548c785a6" />


### 3. Retrieve Token Value
Use the address found in the previous step to read the Token value.

```
dq <System_EPROCESS_Address>+4b8 L1
```
<img width="686" height="393" alt="image" src="https://github.com/user-attachments/assets/7db385ff-f64d-4a73-8554-e3176782f920" />
<img width="621" height="337" alt="image" src="https://github.com/user-attachments/assets/7cc0080c-66f6-4969-83f5-9ec46625ee9d" />

### 4. Exploit & Verify
The tool will locate your process in the kernel, overwrite the token, and spawn a new CMD.
```
whoami
```
<img width="621" height="337" alt="image" src="https://github.com/user-attachments/assets/ff4b0ab3-dab3-4aab-aedb-9c26c50aa2f0" />
