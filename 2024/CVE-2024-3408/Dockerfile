# Vulnerable D-Tale 3.10.0 Lab Environment
# CVE-2024-3408: Authentication Bypass + RCE via hardcoded SECRET_KEY
FROM python:3.8-slim

WORKDIR /app

# Install system dependencies for pandas/numpy
RUN apt-get update && \
    apt-get install -y --no-install-recommends gcc g++ && \
    rm -rf /var/lib/apt/lists/*

# Pin dash to a compatible version, then install vulnerable dtale
# dtale 3.10.0 requires older dash ecosystem
RUN pip install --no-cache-dir \
    dash==2.9.3 \
    dash-colorscales==0.0.4 \
    dash-daq==0.5.0 \
    pandas==1.5.3 \
    dtale==3.10.0

# Create a simple startup script that loads sample data
COPY start.py /app/start.py

EXPOSE 40000

CMD ["python", "/app/start.py"]

