# CVE-2024-12084 

A heap-based buffer overflow flaw was found in the rsync daemon. This issue is due to improper handling of attacker-controlled checksum lengths (s2length) in the code. When MAX_DIGEST_LEN exceeds the fixed SUM_LENGTH (16 bytes), an attacker can write out of bounds in the sum2 buffer.

 ## How does this detection method work?

This template matches on rsync protocol version 31 which has a high liklihood of being vulnerable to CVE-2024-12084.  We can determine this by mapping protocols to versiosn when it comes to rsync. 
```
vulnerable: <= 3.2.7 - protocol 31
unaffected: < 3.4.0 - protocol 32
```
 ## How do I run this script?

1. Download Nuclei from [here](https://github.com/projectdiscovery/nuclei)
2. Copy the template to your local system
3. Run the following command: `nuclei -u https://yourHost.com -t template.yaml` 

## References

- https://nvd.nist.gov/vuln/detail/cve-2024-12084
- https://www.openwall.com/lists/oss-security/2025/01/14/6


## Disclaimer

Use at your own risk, I will not be responsible for illegal activities you conduct on infrastructure you do not own or have permission to scan.

## Contact

Feel free to reach out to me on [Signal](https://signal.me/#eu/0Qd68U1ivXNdWCF4hf70UYFo7tB0w-GQqFpYcyV6-yr4exn2SclB6bFeP7wTAxQw).
