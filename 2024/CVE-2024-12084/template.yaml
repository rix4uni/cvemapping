id: CVE-2024-12084 

info:
  name: CVE-2024-12084
  author: rxerium
  severity: critical
  description: |
    Detects exposures to CVE-2024-12084
  metadata:
    verified: true
    max-request: 1
    shodan-query: rsync 31.0
  tags: js,network,rsync,enum,CVE-2024-12084

javascript:
  - pre-condition: |
      isPortOpen(Host,Port);
    code: |
      let m = require('nuclei/rsync');
      let response = m.IsRsync(Host,Port);
      Export(response);

    args:
      Host: "{{Host}}"
      Port: 873

    matchers:
      - type: word
        words:
          - "31.0"

    extractors:
      - type: json
        name: version
        json:
          - .Banner
